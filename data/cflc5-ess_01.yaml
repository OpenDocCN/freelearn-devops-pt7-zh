- en: Chapter 1. Getting Started with Confluence
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章：开始使用Confluence
- en: Atlassian started back in 2002 and they set out to create software that would
    be inexpensive, easy to use, and would take little effort to install and maintain.
    Thanks to these principles, the installation process of Confluence is relatively
    easy and straightforward; there is even a one-click installation wizard available.
    In this chapter, we will start with a high-level overview of Confluence, looking
    at the different components that make the application. We'll take a look at the
    different deployment options available, including distribution choices, application
    servers, and databases. Finally, we will install our own Confluence application
    from scratch.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Atlassian自2002年起步，他们的目标是创建既便宜又易于使用的软件，并且安装和维护工作量小。正是因为这些原则，Confluence的安装过程相对简单直接；甚至有一键安装向导可用。在本章中，我们将从Confluence的高层次概述开始，查看构成该应用程序的不同组件。我们将探讨可用的不同部署选项，包括发行版选择、应用服务器和数据库。最后，我们将从零开始安装我们自己的Confluence应用程序。
- en: 'By the end of the chapter, you will have learned about:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，你将学到以下内容：
- en: The overall architecture of Confluence
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Confluence的整体架构
- en: Platforms and applications supported by Confluence
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Confluence支持的平台和应用程序
- en: Installing Confluence and all of the required software
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Confluence及所有必需的软件
- en: Configuring database connections
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置数据库连接
- en: Running Confluence, safely
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全地运行Confluence
- en: Understanding the architecture
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解架构
- en: Installing Confluence is simple and straightforward. However, it is important
    for us to understand the components involved in the installation process and the
    options that are available to us. This understanding will help you to make informed
    decisions and be better prepared for troubleshooting and future updates.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Confluence简单明了。然而，理解安装过程中涉及的组件以及可用的选项对我们来说非常重要。理解这些内容将帮助你做出明智的决策，更好地为故障排除和未来的更新做好准备。
- en: High-level architecture
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高层次架构
- en: 'Atlassian has a comprehensive overview of the technical components of Confluence,
    available at [https://developer.atlassian.com/display/CONFDEV/Confluence+Architecture](https://developer.atlassian.com/display/CONFDEV/Confluence+Architecture).
    However, this overview is mainly interesting for those who are developing some
    custom add-ons and not so much for day-to-day administration and usage of Confluence.
    For this reason, we have created a high-level overview that highlights the most
    important components in the architecture, and how our users will connect to Confluence:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Atlassian提供了Confluence技术组件的全面概述，详情请见[https://developer.atlassian.com/display/CONFDEV/Confluence+Architecture](https://developer.atlassian.com/display/CONFDEV/Confluence+Architecture)。然而，这个概述主要对那些开发自定义插件的人比较有兴趣，对日常管理和使用Confluence的管理员帮助不大。因此，我们创建了一个高层次的概述，突出了架构中最重要的组件，以及我们的用户如何连接到Confluence：
- en: '![High-level architecture](img/9526_01_01.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![高层次架构](img/9526_01_01.jpg)'
- en: Supported browsers
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 支持的浏览器
- en: Confluence is a web application, so the only thing our users need for accessing
    it is a compatible web browser. This can be on a desktop system, laptop, or even
    a mobile device such as a smartphone or tablet. The more recent versions of Confluence
    depend heavily on some new web technologies and standards. For this reason, older
    versions of Internet Explorer and Firefox are no longer fully compatible.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence是一个Web应用程序，因此我们的用户只需一个兼容的Web浏览器就能访问它。这个浏览器可以是桌面系统、笔记本电脑，甚至是智能手机或平板电脑等移动设备。Confluence的较新版本依赖于一些新的Web技术和标准。因此，较旧版本的Internet
    Explorer和Firefox已经不再完全兼容。
- en: 'The following table summarizes the browser requirements for Confluence 5.1:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 下表总结了Confluence 5.1的浏览器要求：
- en: '| Browsers | Compatibility |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| 浏览器 | 兼容性 |'
- en: '| --- | --- |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Microsoft Internet Explorer (Windows) | 8, 9 (drag-and-drop not completely
    supported because Internet Explorer doesn''t fully support the related HTML5 feature)
    |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| Microsoft Internet Explorer（Windows） | 8, 9（由于Internet Explorer未完全支持相关的HTML5特性，因此拖放操作不完全支持）
    |'
- en: '| Mozilla Firefox (all platforms) | 10+ |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| Mozilla Firefox（所有平台） | 10+ |'
- en: '| Safari (Windows and Mac) | 5, 6 |'
  id: totrans-20
  prefs: []
  type: TYPE_TB
  zh: '| Safari（Windows和Mac） | 5, 6 |'
- en: '| Google Chrome (Windows and Mac) | 17+ |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '| Google Chrome（Windows和Mac） | 17+ |'
- en: '| Mobile Safari (iOS) | iOS 5.1, 6.0 (editing is not supported on mobile devices)
    |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| 移动Safari（iOS） | iOS 5.1, 6.0（在移动设备上不支持编辑） |'
- en: Data storage
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据存储
- en: The configuration files, attachments, indexes, and add-ons are stored, by default,
    in the Confluence Home directory that is configured when Confluence is first installed.
    All other data resides in the configured database. Optionally, attachments can
    be configured to be stored in the database instead of the Confluence Home directory.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件、附件、索引和插件默认存储在首次安装 Confluence 时配置的 Confluence Home 目录中。所有其他数据存储在配置的数据库中。附件可以选择配置为存储在数据库中，而不是
    Confluence Home 目录中。 |
- en: 'You can choose to store the attachments in the database for ease of backup
    (all data in one single location) or to cope with characters that are invalid
    on your file system. Be aware: storing your attachments in the database increases
    the size of your database drastically. In a clustered environment where data is
    shared between several Confluence installations, you need to store the attachments
    in the database.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以选择将附件存储在数据库中，以便于备份（所有数据集中存放）或是处理在文件系统中无效的字符。请注意：将附件存储在数据库中会大幅增加数据库的大小。在多个
    Confluence 安装共享数据的集群环境中，你需要将附件存储在数据库中。
- en: Confluence Installation directory
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Confluence 安装目录
- en: The directory where you install Confluence is called the Installation directory.
    It contains all the executable and configuration files of the application server.
    Confluence does not modify or store any data in this directory. This directory
    is primarily used for execution. For the remainder of the book we will be referring
    to this directory as `CONF_INSTALL`.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 安装 Confluence 的目录称为安装目录。它包含了所有应用程序服务器的可执行文件和配置文件。Confluence 不会修改或存储任何数据在此目录中。此目录主要用于执行。接下来的内容中，我们将此目录称为
    `CONF_INSTALL`。
- en: Confluence Home directory
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Confluence Home 目录
- en: The Confluence Home directory is the folder where Confluence stores its configuration,
    search indexes, attachments, and add-ons, specific to one Confluence installation.
    This means that every Confluence installation must, and can, have only one Confluence
    Home directory, and each Confluence Home directory can serve only one Confluence
    installation. If you're evaluating Confluence and using the embedded HSQLDB database,
    the database files are also stored in this directory. For the remainder of this
    book we will refer to this directory as `CONF_HOME`.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence Home 目录是 Confluence 存储其配置、搜索索引、附件和插件的文件夹，特定于一个 Confluence 安装。这意味着每个
    Confluence 安装必须且只能有一个 Confluence Home 目录，且每个 Confluence Home 目录只能服务于一个 Confluence
    安装。如果你正在评估 Confluence 并使用内嵌的 HSQLDB 数据库，数据库文件也存储在此目录中。接下来的内容中，我们将此目录称为 `CONF_HOME`。
- en: It's recommended that `CONF_HOME` is created separately from the Confluence
    installation. This separation of data and application makes tasks such as maintenance,
    back ups, and future upgrades easier. Keep in mind that the Confluence Home directory
    can grow quite large on an intensively used site.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 推荐将 `CONF_HOME` 单独创建，而不是与 Confluence 安装在同一位置。数据和应用程序的分离使得维护、备份和未来升级等任务更加简便。请记住，Confluence
    Home 目录在高度使用的网站上可能会变得非常大。
- en: 'Within `CONF_HOME` there are several important files and subdirectories:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `CONF_HOME` 中有几个重要的文件和子目录：
- en: '| File/Directory | Description |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| 文件/目录 | 描述 |'
- en: '| --- | --- |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `confluence.cfg.xml` | Confluence''s core configuration file; includes the
    configuration for connecting to its database and license key. |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| `confluence.cfg.xml` | Confluence 的核心配置文件；包含连接数据库和许可证密钥的配置。 |'
- en: '| `Attachments/` | All file attachments in the Confluence site are stored under
    this directory. This is the place Confluence keeps attachment files if those are
    not stored in the database. |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| `Attachments/` | Confluence 网站中的所有文件附件都存储在此目录下。如果附件没有存储在数据库中，这里是 Confluence
    存放附件文件的地方。 |'
- en: '| `Backups/` | If Confluence is configured to produce daily backups, these
    are stored in this directory. Administrators should occasionally delete old backups
    from this directory to prevent it from growing too large. |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| `Backups/` | 如果 Confluence 配置为每日备份，备份文件将存储在此目录中。管理员应定期删除旧的备份文件，以防止目录变得过大。
    |'
- en: '| `Bundled-plugins/` | Add-ons bundled with the Confluence installation are
    stored here. User-installed plugins are not kept in this directory. |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| `Bundled-plugins/` | 与 Confluence 安装捆绑的插件存储在此目录中。用户安装的插件不会保存在此目录。 |'
- en: '| `Config/` | Miscellaneous global and per-space configuration files are kept
    in this directory. |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| `Config/` | 各种全局和每个空间的配置文件保存在此目录中。 |'
- en: '| `Index/` | The full-text search index is kept in this directory. Removing
    or modifying files in this directory may cause search to no longer function. A
    re-index operation from the Administration console will rebuild the files in this
    folder. |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| `Index/` | 完整文本搜索索引保存在此目录中。删除或修改此目录中的文件可能会导致搜索功能失效。可以通过管理控制台执行重新索引操作，重新生成此文件夹中的文件。
    |'
- en: '| `Logs/` | The application log file is kept here. |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| `Logs/` | 应用程序日志文件保存在此目录中。 |'
- en: '| `Plugins-osgi-cache/` | Plugins installed using the Confluence interface
    are downloaded and kept in this directory. |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| `Plugins-osgi-cache/` | 通过 Confluence 界面安装的插件会下载并保存在此目录中。 |'
- en: '| `Temp/` | Confluence stores temporary files in this directory, especially
    during backups and exports. A daily job within Confluence deletes files that are
    no longer needed. |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| `Temp/` | Confluence 在此目录中存储临时文件，特别是在备份和导出期间。Confluence 内部的定时任务会删除不再需要的文件。
    |'
- en: '| `Thumbnails/` | Stores temporary files for image thumbnails. The contents
    of this directory can be safely deleted, as Confluence will regenerate thumbnails
    as required. |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| `Thumbnails/` | 存储图像缩略图的临时文件。可以安全删除此目录中的内容，因为 Confluence 会在需要时重新生成缩略图。 |'
- en: Installation options
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装选项
- en: Confluence is a Java-based web application, developed using many open standards
    and libraries. For this reason, it is able to run on many different operating
    systems, databases, and application servers. We will take a closer look at the
    options we have, and make an informed decision on what would work best in our
    situation.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 是一个基于 Java 的 Web 应用程序，采用许多开放标准和库进行开发。因此，它能够在许多不同的操作系统、数据库和应用程序服务器上运行。我们将更详细地了解我们拥有的选项，并根据我们的情况做出明智的决策。
- en: Standalone and WAR distributions
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 独立版和 WAR 发行版
- en: 'First, we need to decide on the distribution. Confluence comes in three distributions:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要决定选择哪个发行版。Confluence 提供三种发行版：
- en: One-click installer
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一键安装程序
- en: Standalone bundled with Apache Tomcat
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 独立版捆绑 Apache Tomcat
- en: WAR/EAR distribution
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WAR/EAR 发行版
- en: With regard to the application, there is no difference between the three distributions.
    The installer and standalone distributions are bundled with Apache Tomcat, which
    means we don't have to install and configure an application server ourselves.
    These distributions also come with an embedded in-memory database that can be
    used for evaluation purposes.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 关于应用程序而言，这三种发行版之间没有区别。安装程序版和独立版都捆绑了 Apache Tomcat，这意味着我们不需要自己安装和配置应用程序服务器。这些发行版还包含了一个嵌入式的内存数据库，可以用于评估目的。
- en: The installer is a very handy wrapper around the standalone bundle, automating
    all the steps we normally would have to perform manually. This is great when evaluating
    Confluence, but it doesn't give us much insight into the steps involved in maintaining
    our installation. For this reason, we will use the standalone distribution later,
    when we're going to install Confluence ourselves.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 安装程序是一个非常方便的封装工具，自动化了我们通常需要手动执行的所有步骤。对于评估 Confluence 来说，这非常好，但它并未提供我们在维护安装过程中所涉及步骤的深入了解。因此，当我们需要自己安装
    Confluence 时，我们将使用独立版发行版。
- en: If you already have a running J2EE application server, or are experienced in
    installing and tuning one, the WAR distribution could be something for you. Due
    to differences between application servers, you are required to build the final
    deployment artifact with the provided build scripts. Once the artifact is built,
    you can deploy Confluence just like any other Java web application.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经有一个运行中的 J2EE 应用程序服务器，或者有安装和调优应用服务器的经验，那么 WAR 发行版可能适合你。由于不同应用程序服务器之间的差异，你需要使用提供的构建脚本来构建最终的部署文件。一旦构建完成，你可以像部署任何其他
    Java Web 应用程序一样部署 Confluence。
- en: Operating systems
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作系统
- en: Confluence officially supports Microsoft Windows and Linux (all the distributions).
    Mac OS is supported only as a client platform. The choice of which operating system
    to run Confluence on is mostly a matter of preference based on expertise, and
    in most cases, there is an existing IT infrastructure with specific requirements.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 官方支持 Microsoft Windows 和 Linux（所有发行版）。Mac OS 仅作为客户端平台支持。选择在哪个操作系统上运行
    Confluence 大多是根据专业技能的偏好来决定的，并且在大多数情况下，已有特定需求的 IT 基础设施。
- en: If you do not have any preferences and would like to keep the initial costs
    down, Linux would be a good choice as there are no license fees involved. If you
    have more then 4 GB of memory on your server, make sure to pick a 64-bit version.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有特别偏好并且希望保持初始成本较低，Linux 将是一个不错的选择，因为没有许可证费用。如果您的服务器内存超过 4 GB，请确保选择 64 位版本。
- en: Databases
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据库
- en: Confluence stores all its data in a relational database. The embedded in-memory
    HSQLDB database is only available for evaluation purposes, and should never be
    used in production environments. To limit the risk of data corruption, it's important
    that we use an enterprise database for production systems.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 将所有数据存储在关系型数据库中。嵌入式内存 HSQLDB 数据库仅供评估使用，绝不应在生产环境中使用。为了减少数据损坏的风险，重要的是我们为生产系统使用企业级数据库。
- en: Confluence supports most relational databases available today. There will be
    no noticeable differences during the installation and configuration of Confluence.
    Just like the operating systems, your choice of database will come down to personal
    preference or IT standards within your organization. If you are using Windows
    as your operating system, the most likely choice would be Microsoft SQL Server.
    If you are using Linux, then you should consider PostgreSQL, MySQL, or Oracle.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 支持目前大多数关系型数据库。在安装和配置 Confluence 的过程中不会出现明显差异。就像操作系统一样，您选择的数据库通常取决于个人偏好或您所在组织的
    IT 标准。如果您使用的是 Windows 操作系统，那么最有可能的选择是 Microsoft SQL Server。如果您使用的是 Linux，那么应该考虑
    PostgreSQL、MySQL 或 Oracle。
- en: The following table summarizes the list of databases currently supported by
    Confluence 5.1\. It's worth mentioning that both PostgreSQL and MySQL are available
    as open source (free) products, making them excellent options if you are looking
    to minimize your initial investments.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 下表总结了 Confluence 5.1 当前支持的数据库列表。值得一提的是，PostgreSQL 和 MySQL 都是开源（免费）产品，如果您希望减少初始投资，它们是非常好的选择。
- en: '| Database | Supported version |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 数据库 | 支持版本 |'
- en: '| --- | --- |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| PostgreSQL | 8.4, 9.0 |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| PostgreSQL | 8.4, 9.0 |'
- en: '| MySQL | 5.1, 5.5 |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| MySQL | 5.1, 5.5 |'
- en: '| Microsoft SQL Server | 2005, 2008, 2008 R2 |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| Microsoft SQL Server | 2005, 2008, 2008 R2 |'
- en: '| Oracle | 11.1, 11.2 |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| Oracle | 11.1, 11.2 |'
- en: '| HSQLDB | (for evaluation purposes only) |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| HSQLDB | （仅供评估使用） |'
- en: Application servers
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 应用服务器
- en: Confluence requires a J2EE-compatible application server. The only officially-supported
    application server is Apache Tomcat. Fortunately, Apache Tomcat is an open source
    product and available for every operating system.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 需要一个兼容 J2EE 的应用服务器。唯一官方支持的应用服务器是 Apache Tomcat。幸运的是，Apache Tomcat
    是一个开源产品，适用于所有操作系统。
- en: Confluence 5.1 will only support Tomcat 6.0.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 5.1 仅支持 Tomcat 6.0。
- en: Installing Confluence
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Confluence
- en: Now that we have a good understanding of the overall architecture of Confluence
    and the various installation options, we are ready to install our own Confluence
    instance.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经对 Confluence 的整体架构和各种安装选项有了充分的了解，我们准备安装自己的 Confluence 实例。
- en: In the following exercise, we will be installing and configuring a fresh Confluence
    instance that will be ready for production. We will be using the standalone bundle,
    and the installation will be based upon the Windows platform. If you are planning
    on using a different operating system, please refer to [https://confluence.atlassian.com/display/DOC/Installing+Confluence](https://confluence.atlassian.com/display/DOC/Installing+Confluence)
    for details on installing Confluence on that specific platform.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的练习中，我们将安装和配置一个全新的 Confluence 实例，使其准备好投入生产使用。我们将使用独立包，并且安装将基于 Windows 平台。如果您打算使用其他操作系统，请参考
    [https://confluence.atlassian.com/display/DOC/Installing+Confluence](https://confluence.atlassian.com/display/DOC/Installing+Confluence)
    以获取有关在该平台上安装 Confluence 的详细信息。
- en: 'In this exercise we will:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将：
- en: Install a fresh instance of Confluence
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装全新的 Confluence 实例
- en: Configure Confluence to use a relational database
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 Confluence 以使用关系型数据库
- en: Configure Confluence to send e-mail notifications
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 Confluence 以发送电子邮件通知
- en: Configure Confluence as an auto-start Windows service so that it starts automatically
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 Confluence 为自动启动的 Windows 服务，以便其自动启动
- en: We will continue to use this Confluence instance in other chapters and exercises
    as we prepare Confluence for usage within your own organization.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在后续章节和练习中继续使用此 Confluence 实例，同时为您所在的组织准备 Confluence 的使用。
- en: 'For our implementation, we will be using:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的实现，我们将使用：
- en: Confluence standalone distribution 5.1.0
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Confluence 独立发行版 5.1.0
- en: PostgreSQL 9.0
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PostgreSQL 9.0
- en: Java Development Kit 7 update 9
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Java开发工具包7更新9
- en: Microsoft Windows Server 2008 R2
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microsoft Windows Server 2008 R2
- en: Installing Java
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装Java
- en: Confluence requires Java to be installed on the system, so this is our first
    step. Confluence 5.1 requires the latest update of JDK 7\. If you are installing
    a different version of Confluence, make sure if JDK 7 is supported. Your choice
    between a 32-bit or 64-bit version depends on the amount of memory you want to
    allocate to Confluence; if it's more then 4 GB, pick the 64-bit version as 4 GB
    is the upper limit for the 32-bit version.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence要求系统上安装Java，这是我们的第一步。Confluence 5.1要求最新更新的JDK 7。如果你安装的是不同版本的Confluence，请确认是否支持JDK
    7。选择32位或64位版本取决于你希望为Confluence分配多少内存；如果超过4GB，选择64位版本，因为32位版本的上限是4GB。
- en: Currently, it is only possible to install Confluence as a Windows service if
    it is running on a 32-bit Java version.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 当前，只有在32位Java版本上运行时，才能将Confluence安装为Windows服务。
- en: 'Perform the following steps to install Java on your system:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤在系统中安装Java：
- en: Download the latest version of 32-bit JDK 7 from [http://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html).
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从[http://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html)下载最新版本的32位JDK
    7。
- en: Double-click on the downloaded installation file to start the installation wizard.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击下载的安装文件以启动安装向导。
- en: Select where you would like to install Java; or you can simply accept the default
    values. The location where you install the JDK will be referred to as `JAVA_HOME`
    for the rest of the book.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你希望安装Java的位置；或者你也可以直接接受默认值。安装JDK的路径将在本书中被称为`JAVA_HOME`。
- en: Create a new environmental variable named `JAVA_HOME` with the path where you
    just installed Java, as shown in the following screenshot:![Installing Java](img/9526_01_02.jpg)
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`JAVA_HOME`的新环境变量，路径指向你刚刚安装Java的位置，如下图所示：![安装Java](img/9526_01_02.jpg)
- en: 'Test if installation was successful by typing the following command in the
    command prompt:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在命令提示符中输入以下命令来测试安装是否成功：
- en: '[PRE0]'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'This should display the version of Java installed:'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这应该显示已安装的Java版本：
- en: '[PRE1]'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Installing PostgreSQL
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装PostgreSQL
- en: The next step is to prepare a database for our Confluence installation.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是为我们的Confluence安装准备一个数据库。
- en: 'To install PostgreSQL, simply perform the following steps:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 安装PostgreSQL，请执行以下步骤：
- en: Download PostgreSQL from [http://www.postgresql.org/download/windows/](http://www.postgresql.org/download/windows/).
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从[http://www.postgresql.org/download/windows/](http://www.postgresql.org/download/windows/)下载PostgreSQL。
- en: Note
  id: totrans-101
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: At the time of writing, the most recent version of PostgreSQL was not supported
    by Confluence. We will be using PostgreSQL Version 9.0.12.
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 截至目前，PostgreSQL的最新版本尚不支持Confluence。我们将使用PostgreSQL版本9.0.12。
- en: Double-click on the downloaded installation file to start the installation wizard.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击下载的安装文件以启动安装向导。
- en: Select where you would like to install PostgreSQL and want to store the data.
    We'll be using the default settings during this exercise.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你希望安装PostgreSQL的位置以及存储数据的位置。在本练习中，我们将使用默认设置。
- en: Choose a password for the root user; keep in mind that this is not the password
    for our Confluence database. I used `p0stgre$`, to keep it simple and easy to
    remember during this exercise and confirm to the Windows 2008 password security
    rules.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为root用户选择一个密码；请记住，这不是我们Confluence数据库的密码。我使用了`p0stgre$`，为了简便和易于记住，同时符合Windows
    2008的密码安全规则。
- en: If you choose a different port number, please make sure it doesn't conflict
    with any other services running on your machine. Also remember the port number,
    as we'll need it later.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你选择了不同的端口号，请确保它不会与机器上运行的其他服务发生冲突。并且记住端口号，我们稍后会用到它。
- en: Uncheck the checkbox to make sure Stack Builder isn't launched at the completion
    of the installation process. We don't need it.![Installing PostgreSQL](img/9526_01_03.jpg)
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 取消选中复选框，确保安装过程完成后不会启动Stack Builder。我们不需要它。![安装PostgreSQL](img/9526_01_03.jpg)
- en: Creating a user and a database
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建用户和数据库
- en: Now that PostgreSQL is installed on our machine, we need to create a dedicated
    user and database for Confluence to use. This will prevent other users of the
    application from accessing Confluence data.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 现在PostgreSQL已安装在我们的机器上，我们需要为Confluence创建一个专用的用户和数据库。这样可以防止其他应用用户访问Confluence数据。
- en: 'Perform the following steps to create a new user and a database:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤创建新用户和数据库：
- en: Start the **pgAdmin III** administration tool, which has just been installed
    by the installer. We will be using this administration tool to create the Confluence
    user and database.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动刚刚由安装程序安装的 **pgAdmin III** 管理工具。我们将使用该管理工具来创建 Confluence 用户和数据库。
- en: Connect to the PostgreSQL server running at localhost, by double-clicking on
    the server name. Enter the root password you just picked, when prompted:![Creating
    a user and a database](img/9526_01_04.jpg)
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过双击服务器名称连接到运行在 localhost 上的 PostgreSQL 服务器。在提示时输入您刚刚设置的 root 密码：![创建用户和数据库](img/9526_01_04.jpg)
- en: Create a new user, or "login role," as PostgreSQL calls it. Right-click on **Login
    Roles** in the object browser (on the left) and select **New Login Role...**:![Creating
    a user and a database](img/9526_01_05.jpg)
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新用户，或者说是“登录角色”，正如 PostgreSQL 所称的。右键单击对象浏览器中的 **Login Roles**（在左侧），然后选择 **New
    Login Role...**：![创建用户和数据库](img/9526_01_05.jpg)
- en: 'Enter the username: `confluence`.'
  id: totrans-114
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入用户名：`confluence`。
- en: 'Enter the password: `confluence`.'
  id: totrans-115
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入密码：`confluence`。
- en: Do not select any role privileges.
  id: totrans-116
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不要选择任何角色权限。
- en: Confirm the creation of the role.
  id: totrans-117
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确认角色的创建。
- en: Create a new database; right-click on **Databases** and select **New Database**.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新数据库；右键单击 **Databases** 并选择 **New Database**。
- en: 'Enter the database name: **confuencedb**.'
  id: totrans-119
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入数据库名称：**confuencedb**。
- en: Set the owner of the database to the user we just created.
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据库的所有者设置为我们刚刚创建的用户。
- en: Select **UTF-8** for encoding.
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 **UTF-8** 作为编码方式。
- en: Confirm the creation of the database.
  id: totrans-122
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确认数据库的创建。
- en: That is it. We have installed PostgreSQL and created a user and database for
    our Confluence installation to use.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 就这样。我们已经安装了 PostgreSQL，并为 Confluence 安装创建了一个用户和数据库。
- en: Installing Confluence
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 Confluence
- en: 'Now that we have the JDK and database prepared, we have met all the conditions
    required to install Confluence on our machine. In order to get Confluence installed
    we have to:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经准备好了 JDK 和数据库，满足了在我们的机器上安装 Confluence 所需的所有条件。为了安装 Confluence，我们需要：
- en: Unpack Confluence
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解压 Confluence
- en: Configure the Confluence Home directory
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 Confluence Home 目录
- en: Check the ports Confluence uses
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查 Confluence 使用的端口
- en: Configure e-mail
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置电子邮件
- en: Optionally, we can configure Confluence to use HTTPS and run as a Windows service.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 可选地，我们可以配置 Confluence 使用 HTTPS 并作为 Windows 服务运行。
- en: Unpacking Confluence
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 解压 Confluence
- en: 'Perform the following steps to unpack Confluence:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤解压 Confluence：
- en: Download the latest version of Atlassian Confluence from [www.atlassian.com/software/confluence/download](http://www.atlassian.com/software/confluence/download).
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 [www.atlassian.com/software/confluence/download](http://www.atlassian.com/software/confluence/download)
    下载最新版本的 Atlassian Confluence。
- en: The Atlassian website will detect the operating system you are using and will
    suggest a distribution accordingly. If you intend to install Confluence on a different
    system than the one you are currently on, make sure you select the correct distribution.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Atlassian 网站会自动检测您正在使用的操作系统，并相应地推荐一个发行版。如果您打算在与当前系统不同的系统上安装 Confluence，请确保选择正确的发行版。
- en: As mentioned before, there are one-click installers available for both Windows
    and Linux. For the purpose of this exercise we will be using the ZIP archive,
    as it will provide us with an insight of the steps that are normally hidden by
    the installation process.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前所述，Windows 和 Linux 都提供了一键安装程序。为了本次练习，我们将使用 ZIP 压缩包，因为它将让我们了解安装过程中通常隐藏的步骤。
- en: Extract the downloaded ZIP file to `c:/confluence/`. It is recommended to use
    a third-party unzip software, such as 7-Zip or WinZip, as there are known issues
    with the unzip application provided with Windows. You can choose a different installation
    path; just make sure that you don't use spaces in your directory path.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将下载的 ZIP 文件解压到 `c:/confluence/`。建议使用第三方解压软件，如 7-Zip 或 WinZip，因为 Windows 自带的解压工具存在已知问题。您可以选择不同的安装路径；只需确保目录路径中不要使用空格。
- en: '`C:\confluence\atlassian-confluence-5.1` will now be known as `CONF_INSTALL`.
    Next, we will define the Confluence Home directory.'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`C:\confluence\atlassian-confluence-5.1` 将被称为 `CONF_INSTALL`。接下来，我们将定义 Confluence
    Home 目录。'
- en: Configuring Confluence Home
  id: totrans-138
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置 Confluence Home 目录
- en: Next we have to define and configure `CONF_HOME`. Remember that we want to keep
    our data separated from our installation data.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们需要定义并配置 `CONF_HOME`。记住，我们希望将数据与安装数据分开存储。
- en: Create `c:\confluence\data`; this directory will now be known as `CONF_HOME`.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 `c:\confluence\data`；该目录将被称为 `CONF_HOME`。
- en: Open `CONF_INSTALL` and open the file `confluence\WEB-INF\classes\confluence-init.properties`
    in your favorite text editor.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 `CONF_INSTALL` 并在您喜欢的文本编辑器中打开文件 `confluence\WEB-INF\classes\confluence-init.properties`。
- en: Locate the following line; it's usually at the end of the file.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定位以下行；通常位于文件末尾。
- en: '`# confluence.home=c:/confluence/data`'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`# confluence.home=c:/confluence/data`'
- en: Remove the `#` and the space at the beginning of this line, so that Confluence
    no longer regards it as a comment.
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除此行开头的 `#` 和空格，以便 Confluence 不再将其视为注释。
- en: 'If you have selected a different directory for `CONF_HOME`, then change the
    path accordingly. Please note the following:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您为 `CONF_HOME` 选择了不同的目录，则相应更改路径。请注意以下内容：
- en: Avoid spaces in the directory path.
  id: totrans-146
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 避免在目录路径中使用空格。
- en: Use forward slashes `/` to define the path.
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用斜杠 `/` 定义路径。
- en: Configuring the port
  id: totrans-148
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置端口
- en: By default, Confluence runs on port 8090 with no context path. This means that
    after starting Confluence it will be available at `http://localhost:8090/`. If
    you have another application running on your machine that is using the same ports,
    you may need to change the port Confluence will use. Changing the context path
    is useful when you are running your applications behind a proxy and want to access
    them with the same domain, for example, `http://example.com/jira` and `http://example.com/confluence`.
    For this exercise we will be changing the context Confluence is running on to
    `/confluence`.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Confluence 在端口 8090 上运行，没有上下文路径。这意味着启动 Confluence 后，它将在 `http://localhost:8090/`
    上可用。如果您的机器上有另一个使用相同端口的应用程序运行，您可能需要更改 Confluence 将使用的端口。当您在代理后面运行应用程序并希望使用相同域访问它们时，例如
    `http://example.com/jira` 和 `http://example.com/confluence`，更改上下文路径非常有用。在此练习中，我们将更改
    Confluence 正在运行的上下文为 `/confluence`。
- en: 'To change the ports for Confluence, open the file `conf/server.xml` under your
    `CONF_INSTALL` directory. An extract from that file is shown here:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改 Confluence 的端口，请打开您 `CONF_INSTALL` 目录下的文件 `conf/server.xml`。该文件的摘录如下所示：
- en: '[PRE2]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Tip
  id: totrans-152
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Downloading the example code**'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '**下载示例代码**'
- en: You can download the example code files for all Packt books you have purchased
    from your account at [http://www.packtpub.com](http://www.packtpub.com). If you
    purchased this book elsewhere, you can visit [http://www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files e-mailed directly to you.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从您在 [http://www.packtpub.com](http://www.packtpub.com) 上购买的所有 Packt 图书的帐户中下载示例代码文件。如果您在其他地方购买了这本书，您可以访问
    [http://www.packtpub.com/support](http://www.packtpub.com/support) 并注册，直接将文件通过电子邮件发送给您。
- en: 'Line 1: This line specifies the port for the command to shut down Tomcat. By
    default this port is 8000\. If you already have an application running on that
    port, you can change this to another port.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 第一行：此行指定关闭 Tomcat 命令的端口。默认情况下，此端口为 8000。如果您已经在该端口上运行应用程序，可以将其更改为另一个端口。
- en: 'Line 2: This line specifies on which port Confluence/Tomcat will be running.
    By default this is port 8090\. If that port is unavailable for some reason, you
    can change it to another available port.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 第二行：此行指定 Confluence/Tomcat 将在哪个端口运行。默认情况下，此端口为 8090。如果由于某种原因该端口不可用，可以将其更改为另一个可用端口。
- en: 'Line 3: This line allows you to change the context path on which Confluence
    will be available. By default the path is empty, meaning Confluence will be available
    on `http://hostname:portnumber/`.'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 第三行：此行允许您更改 Confluence 可用的上下文路径。默认情况下，路径为空，这意味着 Confluence 将在 `http://hostname:portnumber/`
    上可用。
- en: For this exercise we will change the context path to `/confluence`, as shown
    in the previous file.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在此练习中，我们将上下文路径更改为 `/confluence`，如前面的文件所示。
- en: Configuring e-mail JNDI resource
  id: totrans-159
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置电子邮件 JNDI 资源
- en: In order to use the share and notification features from Confluence an e-mail
    account has to be set up. Normally, we could do this using the Confluence interface,
    but there is an exception if you want to use SMTPS, with your Gmail account for
    example. So for this exercise we will be configuring Confluence to use your Gmail
    account for sending e-mail notifications to the users.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使用 Confluence 的共享和通知功能，必须设置电子邮件帐户。通常，我们可以使用 Confluence 界面来完成此操作，但是如果您希望使用例如您的
    Gmail 帐户来使用 SMTPS，则存在一个例外。因此，在此练习中，我们将配置 Confluence 以使用您的 Gmail 帐户向用户发送电子邮件通知。
- en: Move (*don't copy*) `activation-1.0.2.jar` and `mail-1.4.1.jar` from `CONF_INSTALL/confluence/WEB-INF/lib`
    to `CONF_INSTALL/lib`.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移动（*不要复制*）`activation-1.0.2.jar` 和 `mail-1.4.1.jar` 从 `CONF_INSTALL/confluence/WEB-INF/lib`
    到 `CONF_INSTALL/lib`。
- en: Add the following resource to your `CONF_INSTALL/conf/server.xml`; make sure
    to add it just before the `</Context>` tag.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下资源添加到你的 `CONF_INSTALL/conf/server.xml` 文件中；确保在 `</Context>` 标签之前添加它。
- en: '[PRE3]'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Replace `yourEmailAddress@gmail.com` and `yourPassword` with the proper values
    for your account.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `yourEmailAddress@gmail.com` 和 `yourPassword` 替换为你账户的正确值。
- en: 'Remember or write down the resource name. When we are configuring Confluence
    and asked for an e-mail server the JNDI location will be:'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记住或写下资源名称。当我们配置 Confluence 并被要求提供电子邮件服务器时，JNDI 位置将是：
- en: '`java:comp/env/mail/GmailSMTPServer`'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`java:comp/env/mail/GmailSMTPServer`'
- en: Note that the name is case-sensitive.
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，名称区分大小写。
- en: Configuring HTTPS
  id: totrans-168
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置 HTTPS
- en: By default, Confluence runs with a standard, non-encrypted HTTP protocol. This
    is acceptable if you are running Confluence in a secured environment, such as
    an internal network. However, if you are planning to open up access to Confluence
    via the Internet, you need to tighten the security. We will be doing this by configuring
    Confluence to run over HTTPS (HTTP over SSL), so that login information and data
    are encrypted during transport over the Internet.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Confluence 使用标准的未加密 HTTP 协议运行。如果你在安全的环境中运行 Confluence，例如内部网络，这种配置是可以接受的。然而，如果你计划通过互联网开放
    Confluence 访问权限，你需要加强安全性。我们将通过将 Confluence 配置为通过 HTTPS（SSL 加密的 HTTP）运行来实现这一点，从而加密登录信息和数据在互联网上传输过程中的安全性。
- en: 'For a standalone installation, we need to perform the following tasks:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 对于独立安装，我们需要执行以下任务：
- en: Create or request a new SSL Certificate
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建或请求一个新的 SSL 证书
- en: Enable HTTPS on our application server
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在我们的应用服务器上启用 HTTPS
- en: Redirect traffic to HTTPS
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将流量重定向到 HTTPS
- en: First, we need to get a digital certificate. This can be one from a Certification
    Authority such as VeriSign or StartSSL (CA certificate), or a self-signed certificate
    generated by you. A CA certificate will not only encrypt your data, but also identify
    your copy of Confluence to users. A self-signed certificate is useful when you
    do not have a valid CA certificate and you are only interested in setting up HTTPS
    for encryption.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要获取一个数字证书。这个证书可以是来自认证机构（如 VeriSign 或 StartSSL）的证书（CA 证书），也可以是由你生成的自签名证书。CA
    证书不仅能加密数据，还能向用户识别你的 Confluence 副本。自签名证书适用于没有有效 CA 证书且仅需设置 HTTPS 以加密数据的情况。
- en: Because a self-signed certificate is not signed by a Certificate Authority,
    users may receive a message that the site is not to be trusted and may have to
    perform several steps to accept the certificate before they can access the site.
    This usually will only occur the first time they access the site. A self-signed
    certificate is great for evaluation purposes, but I would recommend a CA certificate
    for your production environment.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 由于自签名证书没有经过认证机构签名，用户可能会收到提示，表示该站点不可信，并且需要执行一些步骤以接受证书后才能访问该站点。通常这种情况只会在第一次访问时发生。自签名证书非常适合用于评估，但建议在生产环境中使用
    CA 证书。
- en: For the purpose of this exercise we will create a self-signed certificate. If
    you already have a CA certificate you can, of course, use that certificate.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在本次练习中，我们将创建一个自签名证书。如果你已经拥有 CA 证书，当然可以使用该证书。
- en: Generating a certificate
  id: totrans-177
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 生成证书
- en: Follow these steps to generate a certificate using Java's keytool utility. This
    tool is included in the JDK and can be found in `JAVA_HOME/bin`.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤使用 Java 的 keytool 工具生成证书。该工具包含在 JDK 中，可以在 `JAVA_HOME/bin` 找到。
- en: 'Run the following command in the command prompt:'
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在命令提示符下运行以下命令：
- en: '[PRE4]'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'When asked for a password:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当系统要求输入密码时：
- en: Specify the password you want to use for the certificate. Note that the password
    text will not appear as you type.
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定你希望用于证书的密码。请注意，密码输入时不会显示为明文。
- en: Make a note of the password you choose; we will need it in the next step when
    editing the Tomcat configuration.
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记下你选择的密码；我们将在下一步编辑 Tomcat 配置时需要使用该密码。
- en: In this exercise we will be using the default password `changeit`.
  id: totrans-184
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本次练习中，我们将使用默认密码 `changeit`。
- en: Follow the prompts to specify your domain name, organization, and location.
    This information is used to construct the X.500 Distinguished Name (DN) of the
    entity. To the question **What is your first and last name?** (CN), don't give
    your actual name. The CN must match the fully-qualified hostname of the server
    running Confluence. Tomcat will not be able to use the certificate for SSL otherwise.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照提示输入您的域名、组织和位置。这些信息将用于构建实体的 X.500 区别名称 (DN)。对于问题 **您的名字是什么？** (CN)，不要填写您的真实姓名。CN
    必须与运行 Confluence 的服务器的完全限定主机名匹配。否则，Tomcat 将无法使用证书进行 SSL。
- en: 'For example, for our Confluence, running on localhost:'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 例如，对于我们在本地运行的 Confluence：
- en: CN = `localhost`, OU = `Confluence Essentials`, O = `Packt`, C = `UK`
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: CN = `localhost`，OU = `Confluence Essentials`，O = `Packt`，C = `UK`
- en: Enter `y` to confirm the details.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 `y` 以确认详情。
- en: When asked for the password for `tomcat` (the alias you entered in the keytool
    command), press the *Enter* key. You *must* use the same password here as the
    one that was used for the keystore password. This is a restriction of the Tomcat
    implementation.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当系统提示输入 `tomcat` 的密码（您在 keytool 命令中输入的别名）时，按 *Enter* 键。您 *必须* 使用与密钥库密码相同的密码。这是
    Tomcat 实现的限制。
- en: Your certificate is now ready.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在您的证书已准备好。
- en: 'Our self-signed certificate is now available in Java''s keystore. If you are
    using a previously generated certificate or a CA certificate, you will need to
    import that certificate into Java''s keystore. This can be done with the following
    command:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的自签名证书现在已经在 Java 的密钥库中。如果您使用的是之前生成的证书或 CA 证书，您需要将该证书导入到 Java 的密钥库中。可以使用以下命令进行导入：
- en: '[PRE5]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Configuring Tomcat
  id: totrans-193
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置 Tomcat
- en: 'To enable HTTPS, open the `CONF_INSTALL/conf/server.xml` file in a text editor.
    Locate and uncomment the following lines:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用 HTTPS，请打开 `CONF_INSTALL/conf/server.xml` 文件，并在文本编辑器中找到并取消注释以下行：
- en: '[PRE6]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This connector will enable HTTPS for Confluence on port 8443\. We will have
    to replace `<MY_CERTIFICATE_PASSWORD>` with the password we specified when creating
    our certificate. In our case this would be `changeit`.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 这个连接器将为 Confluence 启用 HTTPS，并使用 8443 端口。我们需要将 `<MY_CERTIFICATE_PASSWORD>` 替换为创建证书时指定的密码。在我们的案例中，这个密码是
    `changeit`。
- en: By default, Tomcat expects the keystore file to be named `.keystore` and be
    located in the user home directory under which Tomcat is running. This could be
    a different account than your own, and therefore, can be another directory. If
    your certificate is not in the default location, you will have to update the server
    configuration to include `keystoreFile="<MY_CERTIFICATE_LOCATION>"` in the connector
    element.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Tomcat 期望密钥库文件命名为 `.keystore`，并位于 Tomcat 运行的用户主目录中。这可能与您的用户账户不同，因此可能位于其他目录。如果您的证书不在默认位置，您需要更新服务器配置，在连接器元素中包含
    `keystoreFile="<MY_CERTIFICATE_LOCATION>"`。
- en: Redirecting traffic to HTTPS
  id: totrans-198
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 将流量重定向到 HTTPS
- en: Although HTTPS is now active and available, the old HTTP URLs are still available.
    We will have to set up Confluence so that it will redirect automatically from
    an HTTP to an HTTPS request. We will need to do this by adding a security constraint
    in `web.xml`.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管 HTTPS 已经启用且可用，但旧的 HTTP URL 仍然有效。我们需要配置 Confluence 以便它会自动将 HTTP 请求重定向到 HTTPS。我们需要通过在
    `web.xml` 中添加安全约束来实现这一点。
- en: 'Open `CONF_INSTALL/confluence/WEB-INF/web.xml` and add the following snippet
    to the end of the file, before the `</web-app>` tag:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 `CONF_INSTALL/confluence/WEB-INF/web.xml` 文件，并在文件末尾 `</web-app>` 标签之前添加以下代码片段：
- en: '[PRE7]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This will cause Tomcat to redirect all requests that come in on a non-SSL port.
    The first part will make sure all URLs are checked by this security constraint.
    The second part will guarantee that HTTPS is used for transportation.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 这将导致 Tomcat 将所有进入非 SSL 端口的请求重定向。第一部分将确保所有 URL 都会被此安全约束检查。第二部分将确保使用 HTTPS 进行传输。
- en: Configuring Confluence as a service
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将 Confluence 配置为服务
- en: Under Windows, Confluence can be configured to run as a Windows service, thus
    starting up automatically when the operating system reboots. This is recommended,
    as the alternative is having a console window open on the machine, which could
    be accidentally closed, thus shutting down Confluence.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Windows 下，Confluence 可以配置为 Windows 服务，从而在操作系统重启时自动启动。推荐这样做，因为替代方法是让机器上保持控制台窗口开启，这可能会被意外关闭，导致
    Confluence 停止运行。
- en: 'To configure Confluence as a Windows service, simply perform the following
    steps:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 要将 Confluence 配置为 Windows 服务，只需执行以下步骤：
- en: Start a new command prompt as administrator, and browse to the `CONF_INSTALL/bin`
    directory.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份启动新的命令提示符，并浏览到 `CONF_INSTALL/bin` 目录。
- en: 'Run the following command:'
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令：
- en: '[PRE8]'
  id: totrans-208
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This will install Confluence as a Windows service. The service will be called
    Apache Tomcat Confluence.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将把 Confluence 安装为一个 Windows 服务。该服务将被命名为 Apache Tomcat Confluence。
- en: Verify the configuration by going to the Services console by going to **Start**
    | **Administrative Tools** | **Services**.![Configuring Confluence as a service](img/9526_01_06.jpg)
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过进入 **开始** | **管理工具** | **服务** 来验证配置，访问服务控制台。 ![将 Confluence 配置为服务](img/9526_01_06.jpg)
- en: You can now start, stop, and restart Confluence from the Windows service panel.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以通过 Windows 服务面板启动、停止或重启 Confluence。
- en: Starting Confluence
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启动 Confluence
- en: Everything is in place to start our installation of Confluence. So let us start
    Confluence using the Services console in Windows. Once the server is running,
    you can access Confluence using your Internet browser. The URL to your Confluence
    is `https://localhost:8443/confluence`. If you didn't add the HTTPS or context
    path to your installation, you can find Confluence at `http://localhost:8090/`.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 一切就绪，开始我们的 Confluence 安装。因此，让我们通过 Windows 中的服务控制台启动 Confluence。服务器运行后，您可以使用
    Internet 浏览器访问 Confluence。您的 Confluence URL 是 `https://localhost:8443/confluence`。如果您没有在安装时添加
    HTTPS 或上下文路径，可以通过 `http://localhost:8090/` 访问 Confluence。
- en: 'If you used a self-signed certificate, you will get a prompt that there is
    a certificate error, similar to the one shown in the following screenshot:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用了自签名证书，您将看到一个提示，表明存在证书错误，类似于以下截图所示：
- en: '![Starting Confluence](img/9526_01_07.jpg)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![启动 Confluence](img/9526_01_07.jpg)'
- en: The first page you will see is the first step in the configuration wizard, which
    will finalize your Confluence installation.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到的第一页是配置向导的第一步，它将完成您的 Confluence 安装。
- en: Installation wizard
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装向导
- en: The first step in the wizard is providing a valid license. This can be either
    a full license or an evaluation license. If you have already obtained a license
    from Atlassian, you can cut and paste it into the **License Key** textbox. If
    you don't have a license, you can generate an evaluation license by clicking on
    the **generate an evaluation license online** link. Once you have filled in the
    license key, you have to choose your installation type. We are going to install
    a **Production Installation**, so choose that option.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 向导的第一步是提供有效的许可证。这可以是完整许可证或评估许可证。如果您已经从 Atlassian 获得了许可证，可以将其复制并粘贴到 **License
    Key** 文本框中。如果您没有许可证，可以通过点击 **生成在线评估许可证** 链接来生成一个评估许可证。填写完许可证密钥后，您需要选择安装类型。我们将安装
    **生产环境安装**，所以选择该选项。
- en: '![Installation wizard](img/9526_01_08.jpg)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![安装向导](img/9526_01_08.jpg)'
- en: Step 2 is to configure our database connection. Select **PostgreSQL** from the
    drop-down list at the bottom and click on **External Database**. You will get
    the choice on how to connect to the database. This is either through JDNI or Direct
    JDBC. The difference is that JNDI is configured and managed on the application
    server, just like the SMTPS e-mail server. Direct JDBC is configured within the
    application.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 第 2 步是配置我们的数据库连接。从下拉列表中选择 **PostgreSQL**，然后点击 **外部数据库**。接下来，您将选择如何连接到数据库。这可以通过
    JDNI 或直接 JDBC 进行。区别在于，JNDI 是在应用服务器上配置和管理的，就像 SMTPS 电子邮件服务器一样；而直接 JDBC 是在应用程序内部进行配置的。
- en: For this exercise, we'll be using the Direct JDBC option.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本练习，我们将使用直接 JDBC 选项。
- en: 'On this screen we have to fill out our database configuration:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在此屏幕中，我们需要填写我们的数据库配置：
- en: '![Installation wizard](img/9526_01_09.jpg)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![安装向导](img/9526_01_09.jpg)'
- en: 'Enter the details for your database configuration according to the fields explained
    here:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 根据此处解释的字段，输入数据库配置的详细信息：
- en: '| Property | Value |'
  id: totrans-225
  prefs: []
  type: TYPE_TB
  zh: '| 属性 | 值 |'
- en: '| --- | --- |'
  id: totrans-226
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Driver Class Name | `org.postgresql.Driver` |'
  id: totrans-227
  prefs: []
  type: TYPE_TB
  zh: '| 驱动程序类名 | `org.postgresql.Driver` |'
- en: '| Database URL | `jdbc:postgresql://localhost:5432/confluencedb`If you configured
    a different port number for PostgreSQL, be sure to also change it in this URL.
    |'
  id: totrans-228
  prefs: []
  type: TYPE_TB
  zh: '| 数据库 URL | `jdbc:postgresql://localhost:5432/confluencedb` 如果您为 PostgreSQL
    配置了不同的端口号，请确保在此 URL 中也更改它。 |'
- en: '| User Name | `confluence` |'
  id: totrans-229
  prefs: []
  type: TYPE_TB
  zh: '| 用户名 | `confluence` |'
- en: '| Password | `confluence` |'
  id: totrans-230
  prefs: []
  type: TYPE_TB
  zh: '| 密码 | `confluence` |'
- en: Click on **Next** to start the initialization of the database. This could take
    a while, so hold on.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 **下一步** 开始初始化数据库。这个过程可能需要一段时间，请耐心等待。
- en: 'After the database is initialized, you will get to the next screen (shown in
    the next screenshot), where you can choose how you would like to load content:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库初始化后，你将进入下一屏（见下图），在这里你可以选择如何加载内容：
- en: '**Example Site**: This will load a demonstration space into Confluence, showing
    some of the features Confluence has to offer. Great if you want to evaluate Confluence.'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**示例站点**：这将把一个演示空间加载到 Confluence 中，展示 Confluence 提供的一些功能。如果你想评估 Confluence，这是一个不错的选择。'
- en: '**Empty Site**: A clean Confluence installation, without any space or content.
    Perfect if you are already familiar with Confluence and want to get started quickly.'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**空白站点**：一个干净的 Confluence 安装，没有任何空间或内容。如果你已经熟悉 Confluence 并想快速开始，这将是完美的选择。'
- en: '**Restore From Backup**: If you already have a Confluence installation and
    a backup from that installation, you can import it using this option. Make sure
    that the backup data is from the same major version as the target Confluence.![Installation
    wizard](img/9526_01_10.jpg)'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从备份恢复**：如果你已经有一个 Confluence 安装和该安装的备份，你可以使用此选项进行导入。确保备份数据与目标 Confluence 的主要版本相同。![安装向导](img/9526_01_10.jpg)'
- en: For our installation we will pick **Example Site**, as this gives us some exposure
    on how we could use Confluence.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的安装，我们将选择**示例站点**，因为这可以让我们了解如何使用 Confluence。
- en: Once **Example Site** is loaded, it is time to set up user management. Choose
    to set up user management within Confluence. Connecting user management to an
    external source is discussed in [Chapter 2](ch02.html "Chapter 2. User Management"),
    *User Management*.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦加载了**示例站点**，就可以开始设置用户管理了。选择在 Confluence 内部设置用户管理。将用户管理连接到外部来源的内容在[第2章](ch02.html
    "第2章 用户管理")，*用户管理*中有详细讨论。
- en: Set up the System Administrator account and make sure you remember the username/password,
    because Confluence only stores the hashed value of your password. You will not
    be able to retrieve it.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 设置系统管理员账户，并确保记住用户名/密码，因为 Confluence 仅存储密码的哈希值。你将无法找回密码。
- en: '![Installation wizard](img/9526_01_11.jpg)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![安装向导](img/9526_01_11.jpg)'
- en: Confluence is now ready for use; you can either start using it or continue configuring.
    As for this exercise, we want to continue and set up the e-mail server, so choose
    **Continue configuration**. After logging in with your system administrator account,
    you will see the Confluence Administrator console.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: Confluence 现在已经可以使用；你可以选择开始使用或者继续配置。对于本次练习，我们希望继续并设置电子邮件服务器，因此请选择**继续配置**。在使用系统管理员账户登录后，你将看到
    Confluence 管理控制台。
- en: Setting up the e-mail server
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置电子邮件服务器
- en: Log in to Confluence and go to the **Administration Console** by going to **Administration**
    | **Confluence Admin**. You might have to log in another time due to Confluence's
    **WebSudo**. WebSudo prevents other people from accessing the administrator console,
    if you left your machine unattended, for example.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 登录 Confluence，并通过访问**管理** | **Confluence 管理员**进入**管理控制台**。由于 Confluence 的**WebSudo**，你可能需要再次登录。WebSudo
    可防止他人访问管理员控制台，例如，当你离开电脑未锁定时。
- en: In **Administration** **Console**, select **Mail Servers** in the left menu.
    Select **Add a new SMTP mail server** to add a new SMTP mail server that Confluence
    will use to send notifications and password resets.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 在**管理控制台**中，在左侧菜单选择**邮件服务器**。选择**添加新的 SMTP 邮件服务器**，以添加一个新的 SMTP 邮件服务器，Confluence
    将使用该服务器来发送通知和密码重置邮件。
- en: '| Property | Description |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
  zh: '| 属性 | 描述 |'
- en: '| --- | --- |'
  id: totrans-245
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Name | The name of the SMTP server used for reference within Confluence.
    |'
  id: totrans-246
  prefs: []
  type: TYPE_TB
  zh: '| 名称 | 用于在 Confluence 中引用的 SMTP 服务器名称。 |'
- en: '| From address | Enter the e-mail address the e-mail is sent from. In most
    cases this must be the same address as the e-mail account you''re using. |'
  id: totrans-247
  prefs: []
  type: TYPE_TB
  zh: '| 发件地址 | 输入电子邮件发送者的地址。在大多数情况下，这必须与所使用的电子邮件账户相同。 |'
- en: '| From Name | Enter the name that will be displayed in the `from` field for
    e-mail messages originating from this server. This field accepts the following
    variables, which reference specific details defined in the relevant Confluence
    user''s profile:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '| 发件人名称 | 输入该服务器发送的电子邮件在`发件人`字段中显示的名称。此字段接受以下变量，这些变量引用相关 Confluence 用户档案中定义的具体细节：'
- en: '`${fullname}`, The user''s full name'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`${fullname}`，用户的全名'
- en: '`${email}`, The user''s e-mail address'
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`${email}`，用户的电子邮件地址'
- en: '`${email.hostname}`, the domain name of the user'
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`${email.hostname}`，用户的域名'
- en: The default is `${fullname} (Confluence)`. |
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 默认值是 `${fullname} (Confluence)`。
- en: '| Subject Prefix | Enter some text to appear at the beginning of the subject
    line. |'
  id: totrans-253
  prefs: []
  type: TYPE_TB
  zh: '| 主题前缀 | 输入一些文本以显示在主题行的开头。 |'
- en: 'Enter *either* the hostname and credentials of your mail server, or the JDNI
    resource. As we set up a Gmail account earlier, we will be using that one:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 输入 *either* 你的邮件服务器的主机名和凭证，或者 JDNI 资源。由于我们之前设置了一个 Gmail 账户，我们将使用这个：
- en: '![Setting up the e-mail server](img/9526_01_12.jpg)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![设置电子邮件服务器](img/9526_01_12.jpg)'
- en: The JNDI location will be **java:comp/env/mail/GmailSMTPServer**.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: JNDI 地址将是 **java:comp/env/mail/GmailSMTPServer**。
- en: Submit the configuration, and try to send a test e-mail to yourself to verify
    the settings.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 提交配置，并尝试向自己发送一封测试邮件以验证设置。
- en: Summary
  id: totrans-258
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述
- en: We have seen that getting started with Confluence is fairly straightforward;
    it is also very flexible with regard to options you can choose from, when installing
    your copy of Confluence. You can mix these options to suit your situation best,
    or to comply with your IT department's requirements. If you wish to keep initial
    costs as low as possible, you can install Confluence completely with open source
    software, such as Linux and Postgresql, which are available for free.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到，开始使用 Confluence 是相当简单的；它在安装时提供了非常灵活的选项，你可以根据自己的情况选择合适的选项，或者根据 IT 部门的要求进行配置。如果你希望将初期成本保持在最低，可以完全使用开源软件安装
    Confluence，例如 Linux 和 Postgresql，这些软件是免费的。
- en: Now that we have installed Confluence and gone through the set up wizard, we
    will start to dive deeper into the various aspects of Confluence. In the next
    chapter, we will go into how to manage your users and groups, as Confluence is
    not intended to be used alone.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经安装了 Confluence 并完成了设置向导，接下来我们将深入探讨 Confluence 的各个方面。在下一章中，我们将讨论如何管理用户和组，因为
    Confluence 并非单独使用。
