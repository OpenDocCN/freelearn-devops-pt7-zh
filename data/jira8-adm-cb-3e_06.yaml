- en: Emails and Notifications
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 电子邮件和通知
- en: Email is one of the most important communication tools in the world. It is a
    technology that people are familiar with and had the least amount of resistance
    in regard to its adoption. Therefore, these days email integration has become
    one of the key features of any system. Help-desk systems, CRMs, and even document-management
    systems all need to be able to both send and receive emails. So it is not surprising
    that Jira comes with a full list of email integration features out of the box.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件是世界上最重要的通信工具之一。它是一项人们熟悉且对其采纳阻力最小的技术。因此，电子邮件集成如今已成为任何系统的关键功能之一。帮助台系统、客户关系管理系统（CRM）甚至文档管理系统都需要能够发送和接收电子邮件。因此，Jira自带一整套电子邮件集成功能也就不足为奇了。
- en: In this chapter, we will learn how to configure Jira to send out email notifications
    every time someone makes a change to issues, set up notification rules to manage
    email recipients, and create mail templates to customize email content. We will
    also look at how Jira can process emails and create issues automatically, saving
    us the effort of manual data entry.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何配置Jira，使其在每次有人更改问题时发送电子邮件通知，设置通知规则来管理电子邮件接收者，并创建邮件模板来自定义电子邮件内容。我们还将探讨Jira如何处理电子邮件并自动创建问题，从而节省手动输入数据的工作。
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下内容：
- en: Setting up an outgoing mail server
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置外发邮件服务器
- en: Sending emails to users from Jira
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从Jira发送电子邮件给用户
- en: Sending notifications for issue updates
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发送问题更新的通知
- en: Sending notifications with custom templates
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用自定义模板发送通知
- en: Disabling outgoing notifications
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 禁用外发通知
- en: Creating mail handlers to process incoming emails
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建邮件处理程序以处理传入电子邮件
- en: Using emails to update Jira issues
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用电子邮件更新Jira问题
- en: Setting up a project-specific From email address
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置项目特定的发件人电子邮件地址
- en: Setting up an outgoing mail server
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置外发邮件服务器
- en: In this recipe, we will look at how to set up an outgoing mail server in Jira
    that can be used to send direct emails to users or automated notifications when
    updates are made to issues.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何在Jira中设置一个外发邮件服务器，用于直接发送电子邮件给用户或在问题更新时发送自动通知。
- en: Getting ready
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Jira requires a working mail server to send emails, and it uses the **SMTP**
    (short for **Simple Mail Transfer Protocol**) to communicate with the mail server.
    Because of this, you will need the following:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Jira需要一个有效的邮件服务器来发送电子邮件，它使用**SMTP**（即**简单邮件传输协议**）与邮件服务器通信。因此，您需要以下内容：
- en: A working mail server that is either on the same server as Jira or accessible
    over the network
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个工作中的邮件服务器，要么与Jira位于同一服务器上，要么可以通过网络访问
- en: Connectivity details, including the mail server's host, port, protocol (SMTP
    or secured SMTP), and SSL certificate if it is using a self-signed certificate
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接详细信息，包括邮件服务器的主机、端口、协议（SMTP或安全SMTP），以及如果使用自签名证书，则需要SSL证书
- en: Authentication details for Jira to log in to the mail server
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Jira登录邮件服务器的认证信息
- en: How to do it...
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'Go through the following steps to set up an outgoing mail server:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤设置一个外发邮件服务器：
- en: Log in to Jira as a Jira administrator.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以Jira管理员身份登录Jira。
- en: Navigate to Administration > System > Outgoing Mail.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**管理** > **系统** > **外发邮件**。
- en: Click on the Configure new SMTP mail serverbutton.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**配置新的SMTP邮件服务器**按钮。
- en: Set a name for the mail server. For example, you can use the mail server's hostname.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置邮件服务器的名称。例如，您可以使用邮件服务器的主机名。
- en: Set the From addressfield that will be used when users receive an email from
    Jira.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置“发件人”地址字段，用户收到Jira发送的电子邮件时将使用此地址。
- en: Provide an Email prefixvalue, which will be added to every email's subject.
    For example, you can use `[Jira]` to let users know it is coming from Jira.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供一个**电子邮件前缀**值，该值将添加到每封邮件的主题中。例如，您可以使用`[Jira]`来让用户知道邮件来自Jira。
- en: Select whether you will be using a custom SMTP server or one from either Gmail
    or Yahoo! mail. If you are using Gmail or Yahoo!, make sure you select the corresponding
    option and provide the access credentials. If you are using a custom SMTP server,
    you will need to provide its hostname, port number, and credentials, if necessary.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择是使用自定义SMTP服务器，还是使用Gmail或Yahoo!邮件的服务器。如果使用Gmail或Yahoo!，请确保选择相应的选项并提供访问凭据。如果使用自定义SMTP服务器，您需要提供其主机名、端口号以及必要时的凭据。
- en: 'Click on the Test Connection button, with the credentials provided, to make
    sure Jira is able to connect to the mail server. If the test is successful, click
    on the Add button, as shown in the following screenshot:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**测试连接**按钮，使用提供的凭据确保 Jira 能够连接到邮件服务器。如果测试成功，点击**添加**按钮，如下图所示：
- en: '![](img/27f85913-6cce-4767-81f7-7e982fc67a6e.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](img/27f85913-6cce-4767-81f7-7e982fc67a6e.png)'
- en: You can only have one outgoing mail server.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 你只能设置一个外发邮件服务器。
- en: 'Once we have configured the outgoing mail server in Jira, we can send a test
    email to make sure everything is working properly:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们在 Jira 中配置了外发邮件服务器，我们可以发送测试邮件以确保一切正常工作：
- en: Click on the Send a Test Email link.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**发送测试邮件**链接。
- en: Verify whether the email address in the **To **field is the one that you have
    access to. Jira will automatically populate it with the email address of the currently
    logged-in user.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证**To**字段中的电子邮件地址是否是你可以访问的地址。Jira 会自动填充当前登录用户的电子邮件地址。
- en: Click on the **Send **button to send the test email.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**发送**按钮发送测试邮件。
- en: 'Jira will immediately send out the test email (normal notification emails are
    placed in a queue before they are sent) to the address in the **To** field, with
    the Subject and Body content specified, as shown in the following screenshot.
    If there is an error, you can check the SMTP logging checkbox to get more details
    on the error:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: Jira 会立即向**To**字段中的地址发送测试邮件（普通通知邮件会排队等待发送），邮件主题和正文内容将按所指定的方式显示，如下图所示。如果出现错误，你可以勾选SMTP日志复选框以获取更多错误细节：
- en: '![](img/2c21791a-2a09-4847-9e0e-07a9d5d4a4ee.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2c21791a-2a09-4847-9e0e-07a9d5d4a4ee.png)'
- en: We have now successfully set up an outgoing email server.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经成功设置了外发邮件服务器。
- en: Sending emails to users from Jira
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从 Jira 向用户发送电子邮件
- en: With the outgoing mail server set up, we will now be able to send emails directly
    from Jira. One common use case is sending out reminders, such as system maintenance
    notices, to everyone in Jira, or sending important updates to members of a project.
    In this recipe, we will look at how to perform these types of tasks with Jira.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 设置好外发邮件服务器后，我们现在可以直接从 Jira 发送电子邮件了。一个常见的使用场景是发送提醒邮件，比如系统维护通知，发送给 Jira 中的所有人，或者向项目成员发送重要更新。在这个教程中，我们将展示如何使用
    Jira 执行这些任务。
- en: Getting ready
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: You must first configure an outgoing mail server for Jira. Refer to the previous
    recipe, *Setting up an outgoing mail server*, for more details.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 你必须首先为 Jira 配置一个外发邮件服务器。有关更多详细信息，请参阅前面的教程，*设置外发邮件服务器*。
- en: How to do it...
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Go through the following steps to send out direct emails to users in Jira:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤将邮件直接发送给 Jira 中的用户：
- en: Navigate to Administration > **System** > **Send email**.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**管理** > **系统** > **发送邮件**。
- en: Select the recipients of the email. You can choose to send an email via **Project
    Roles **or **Groups**. For example, to send an email to everyone who uses Jira,
    you can select the **jira-software-users** group (if it is the group that all
    of the users are in).
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择电子邮件的收件人。你可以选择通过**项目角色**或**群组**发送电子邮件。例如，要向所有使用 Jira 的用户发送电子邮件，你可以选择**jira-software-users**群组（如果它是所有用户所在的群组）。
- en: Type in your email **Subject **and **Body**.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入你的电子邮件**主题**和**正文**。
- en: Check the **Bcc **checkbox if you do not want people to see other recipients'
    email addresses.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你不希望收件人看到其他收件人的电子邮件地址，请勾选**Bcc**复选框。
- en: 'Click on the **Send **button to send the email, as shown in the following screenshot:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**发送**按钮以发送电子邮件，如下图所示：
- en: '![](img/482bd1ec-4180-4b12-a4a9-d5a3b4e4dfe1.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/482bd1ec-4180-4b12-a4a9-d5a3b4e4dfe1.png)'
- en: This completes the steps to send emails to users.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这些步骤完成了向用户发送电子邮件的操作。
- en: Sending notifications for issue updates
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发送问题更新通知
- en: The other major use of outgoing mails is for Jira to automatically send out
    notifications about changes to issues. For example, if an issue has been updated,
    you would want the issue's reporter and assignee to be notified of the change.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 另一项外发邮件的主要用途是让 Jira 自动发送关于问题变更的通知。例如，如果某个问题被更新，你希望该问题的报告人和处理人收到变更通知。
- en: In this recipe, we will look at how to set up notification rules so that interested
    parties are notified of any changes to their issues.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将展示如何设置通知规则，以便相关方能够接收到其问题变更的通知。
- en: Getting ready
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: You must first configure an outgoing mail server for Jira. Refer to the *Setting
    up an outgoing mail server* recipe for more details.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 你必须首先为 Jira 配置一个外发邮件服务器。有关更多详细信息，请参阅*设置外发邮件服务器*教程。
- en: How to do it...
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Jira uses notification schemes to control who should receive notifications
    when there are any changes in issues. Jira comes with a default notification scheme
    that is applied to all projects by default. You can update this default scheme''s
    notification settings by clicking on its **Notifications** link. In this recipe,
    however, we will be creating a new notification scheme and applying it to projects.
    If you want to use the default notification scheme, you can skip the new scheme
    creation steps and go straight to step 2:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: Jira 使用通知方案来控制在问题发生任何变化时，谁应该接收通知。Jira 自带一个默认的通知方案，默认应用于所有项目。你可以通过点击其**通知**链接来更新此默认方案的通知设置。然而，在本教程中，我们将创建一个新的通知方案并将其应用到项目。如果你想使用默认通知方案，可以跳过创建新方案的步骤，直接进入第
    2 步：
- en: 'Go through the following steps to create a new notification scheme:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下步骤创建一个新的通知方案：
- en: Navigate to **Administration** > **Issues** > **Notification schemes**.
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**管理** > **问题** > **通知方案**。
- en: Click on the **Add notification scheme **link.
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加通知方案**链接。
- en: Enter a name for the new scheme and click on **Add **to create it.
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入新方案的名称，然后点击**添加**来创建它。
- en: After you have created a new notification scheme, you will be taken to the notification
    settings page for the scheme. By default, there will be no notifications set for
    any event.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 创建新的通知方案后，系统将带你进入该方案的通知设置页面。默认情况下，任何事件都没有设置通知。
- en: 'To add a notification recipient to an event, go through the following steps:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将通知接收者添加到事件，请按照以下步骤进行：
- en: Click on the Add link for the event.
  id: totrans-64
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击事件的**添加**链接。
- en: Select the type of notification recipient (for example, the `Group` option,
    as shown in the following screenshot), and click on **Add**.
  id: totrans-65
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择通知接收者的类型（例如，`组`选项，如下图所示），然后点击**添加**。
- en: 'You can add a notification recipient to multiple events at the same time by
    using the multi-select events field. The following screenshot of the **Add Notification** page
    shows this:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过使用多选事件字段，将一个通知接收者添加到多个事件中。下图展示了**添加通知**页面的内容：
- en: '![](img/6b23d0c1-2c2a-4753-bf9c-06ece0eda95e.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6b23d0c1-2c2a-4753-bf9c-06ece0eda95e.png)'
- en: You can add as many notification recipients as you need for an event, and Jira
    will not send duplicate emails to the same user. For example, if you have set
    both the reporter and assignee to receive notifications for a single event, and
    they happen to be the same user, Jira will only send out one email instead of
    two. Also, note that Jira will take permissions into consideration when sending
    out notifications. If a user does not have access to the issue, Jira will not
    send notifications to that user.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以为每个事件添加尽可能多的通知接收者，Jira 不会向同一用户发送重复的邮件。例如，如果你设置了报告人和指派人都接收某个事件的通知，并且他们恰好是同一个用户，Jira
    只会发送一封邮件，而不是两封。另外，请注意，Jira 在发送通知时会考虑权限。如果某个用户没有访问权限，Jira 将不会向该用户发送通知。
- en: 'The last step is to apply our new notification scheme to a project:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后一步是将我们新的通知方案应用到项目中：
- en: Browse to the project you want to apply the notification scheme to.
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 浏览到你想要应用通知方案的项目。
- en: Click on the **Project settings **option.
  id: totrans-71
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**项目设置**选项。
- en: Select the **Notifications **option from the panel on the left-hand side.
  id: totrans-72
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从左侧面板中选择**通知**选项。
- en: Select **Use a different scheme **from the **Actions** menu.
  id: totrans-73
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**操作**菜单中选择**使用不同的方案**。
- en: Select the new notification scheme and click on **Associate**.
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择新的通知方案，然后点击**关联**。
- en: How it works...
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Jira uses an event system where every issue operation, such as creating a new
    issue or workflow transition, will trigger a corresponding event to be fired.
    As we have seen, notification schemes map events to notification recipients. This
    way, we are able to set up flexible notification rules to notify different people
    for different events.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: Jira 使用一个事件系统，其中每个问题操作，如创建新问题或工作流转换，都将触发一个相应的事件。正如我们所看到的，通知方案将事件映射到通知接收者。通过这种方式，我们能够设置灵活的通知规则，通知不同的人不同的事件。
- en: Jira provides many different notification recipient types. Some, such as Current
    Assignee and Reporter, are very simple—they will simply take the value of the
    current issue's assignee and reporter field respectively. Other options, such
    as User Custom Field Value, can be very flexible. For example, you can create
    a multi-user picker custom field, and for each issue, you can have a different
    list of users as recipients, without having to modify the actual scheme itself.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: Jira提供了许多不同的通知接收人类型。有些接收人类型，如当前指派人和报告人，非常简单——它们分别仅使用当前问题的指派人和报告人字段的值。其他选项，例如用户自定义字段值，可以非常灵活。例如，你可以创建一个多用户选择自定义字段，并为每个问题指定不同的用户列表作为接收人，而无需修改实际的通知方案。
- en: Events are also mapped to email templates so that Jira knows what to use for
    the subject and body. You cannot change the mapping for system events, but as
    we will see in the next recipe, we can create custom events and select which templates
    to use.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 事件也会映射到邮件模板，以便Jira知道使用哪个模板来设置主题和正文。系统事件的映射无法更改，但正如我们在下一步中看到的，我们可以创建自定义事件并选择使用哪些模板。
- en: There's more...
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Being automatically notified of any changes that happen in Jira is convenient,
    but if you have a busy Jira, you might find yourself buried in emails as a result
    of too many updates. To help with that, you can enable the new email batching
    feature. By enabling batching, instead of receiving an email for each update that
    happens to an issue, Jira will group all updates for a given issue and send you
    a summary email instead. To enable email batching, go through the following steps:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 自动接收Jira中发生的任何更改的通知非常方便，但如果你有一个繁忙的Jira，你可能会因为更新太多而陷入大量邮件中。为了解决这个问题，你可以启用新的邮件批量处理功能。启用批量处理后，Jira不会为每个更新单独发送邮件，而是将一个问题的所有更新进行分组，并发送一封汇总邮件给你。要启用邮件批量处理，请按以下步骤操作：
- en: Navigate to Administration > System > Batching email notification.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进入“管理” > “系统” > “批量邮件通知”。
- en: Check the Batching email notification option to enable the feature.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 勾选“批量邮件通知”选项以启用该功能。
- en: Sending notifications with custom templates
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用自定义模板发送通知
- en: In the previous recipe, *Sending notifications for issue updates*, we looked
    at how to set up notification schemes by mapping events to notification recipients.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的教程《*发送问题更新通知*》中，我们查看了如何通过将事件映射到通知接收人来设置通知方案。
- en: 'In this recipe, we will expand on that and look at how to create custom events
    and templates to use for notifications. This has two advantages:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将进一步探讨如何创建自定义事件和模板用于通知。这有两个优势：
- en: We can customize the content and the look and feel of the notification email
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以自定义通知邮件的内容和外观。
- en: We can specify exactly which event will be fired for each workflow transition
    and set up notification rules accordingly
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以精确指定每个工作流转换将触发的事件，并相应地设置通知规则。
- en: We will create a new event that will represent a request that has been approved
    by the management to proceed. This event will be triggered in an approve workflow
    transition and will have a custom template applied to it.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将创建一个新事件，表示管理层已批准的请求。此事件将在批准的工作流转换中触发，并应用自定义模板。
- en: How to do it...
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The first step is to create our custom email templates. All mail templates
    are stored in the `JIRA_INSTALL/atlassian-jira/WEB-INF/classes/templates/email` directory,
    and generally, for each event in Jira, there are three template files:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是创建我们的自定义邮件模板。所有邮件模板都存储在`JIRA_INSTALL/atlassian-jira/WEB-INF/classes/templates/email`目录下，通常，对于Jira中的每个事件，有三个模板文件：
- en: '**The subject template**: This is the template file for the email''s subject
    line, which is stored in the `subject` subdirectory.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主题模板**：这是邮件主题行的模板文件，存储在`subject`子目录中。'
- en: '**The text template**: This is the template file for emails sent in text format,
    which is stored in the `text` subdirectory.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文本模板**：这是发送文本格式邮件的模板文件，存储在`text`子目录中。'
- en: '**The HTML template**: This is the template file for emails sent in HTML format,
    which is stored in the `html` subdirectory.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HTML模板**：这是发送HTML格式邮件的模板文件，存储在`html`子目录中。'
- en: To start creating our own email templates, we first need to create the three
    files mentioned in the previous list of template files and place them in their
    respective directories. Take special note that all three files need to have the
    same filename with a `.vm` extension.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始创建我们自己的电子邮件模板，首先需要创建前面提到的三个模板文件，并将它们放置在各自的目录中。特别注意，所有三个文件需要具有相同的文件名并且扩展名为
    `.vm`。
- en: 'We will start with the subject template, as follows:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从主题模板开始，如下所示：
- en: 'Create a new file called `issueapproved.vm` in the `subject` subdirectory with
    the following code snippet:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `subject` 子目录下创建一个名为 `issueapproved.vm` 的新文件，并添加以下代码片段：
- en: '[PRE0]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We now need to create the body of the email, keeping in mind that we have to
    create two versions—one for text and one for HTML. The following snippet shows
    the HTML version; for the text version, simply remove the HTML markups. Note that
    both HTML and text template files need to be the same—that is, `issueapproved.vm`:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们需要创建电子邮件的正文，记住要创建两个版本——一个是文本版本，一个是 HTML 版本。以下代码片段显示了 HTML 版本；对于文本版本，只需删除
    HTML 标记即可。注意，HTML 和文本模板文件需要是相同的——即 `issueapproved.vm`：
- en: '[PRE1]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: After we have created all three template files, we need to register them in
    Jira so that they can be selected while creating custom events. To register new
    email templates, open the `email-template-id-mappings.xml` file in a text editor;
    you can find the file inside the `JIRA_INSTALL/atlassian-jira/WEB-INF/classes` directory.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在创建完所有三个模板文件后，我们需要在 Jira 中注册它们，以便在创建自定义事件时可以选择这些模板。要注册新的电子邮件模板，打开 `email-template-id-mappings.xml`
    文件，可以在 `JIRA_INSTALL/atlassian-jira/WEB-INF/classes` 目录下找到该文件。
- en: 'The `email-template-id-mappings.xml` file lists all the email templates in
    Jira, so we need to add a new entry at the end, as follows:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`email-template-id-mappings.xml` 文件列出了 Jira 中所有的电子邮件模板，因此我们需要在文件末尾添加一个新条目，如下所示：'
- en: '[PRE2]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'There are a few points to note here:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有几个要注意的要点：
- en: The `id` value of `<templatemapping>` needs to be unique.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`<templatemapping>` 的 `id` 值需要是唯一的。'
- en: You can give any value to the `<name>` element and it will be displayed in Jira.
    It is good practice to keep it consistent with standard Jira event convention.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以为 `<name>` 元素赋予任意值，它将在 Jira 中显示。遵循标准的 Jira 事件命名规范是一个良好的实践。
- en: The `<template>` element should be the name of the custom template files we
    have created. All three files need to have the same filename since we can only have
    one `<template>` element.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`<template>` 元素应为我们创建的自定义模板文件的名称。所有三个文件需要具有相同的文件名，因为我们只能有一个 `<template>` 元素。'
- en: The `<templatetype>` element needs to have the value set to `issueevent`.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`<templatetype>` 元素需要设置为 `issueevent`。'
- en: Once you have added the entry and saved the file, you will need to restart Jira
    for the changes to be applied.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 添加条目并保存文件后，你需要重启 Jira 才能应用这些更改。
- en: 'Now that we have our custom email templates in place, we can create the custom
    event that will use our new templates. Go through the following steps to create
    a custom event in Jira:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经准备好了自定义电子邮件模板，可以创建将使用这些新模板的自定义事件。按照以下步骤在 Jira 中创建自定义事件：
- en: Navigate to Administration > System > Events.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 管理 > 系统 > 事件。
- en: Enter `Issue Approved` for the new event's name.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为新事件的名称输入 `Issue Approved`。
- en: Select the **Issue Approved **template we just created.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择我们刚刚创建的 **Issue Approved** 模板。
- en: 'Click on the **Add** button to create the new event:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **添加** 按钮以创建新事件：
- en: '![](img/82b5b36f-ef53-4ac3-a920-70d8ab9ff941.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/82b5b36f-ef53-4ac3-a920-70d8ab9ff941.png)'
- en: 'Once you have created the event, it will be available in the notification schemes,
    and we will be able to select who will receive email notifications by configuring
    our notification schemes—as shown in the following screenshot. Whenever an issue
    is approved, both the reporter and the user Christine will be notified:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 创建完事件后，它将出现在通知方案中，我们可以通过配置通知方案来选择接收电子邮件通知的人——如下图所示。每当问题被批准时，报告人和用户 Christine
    都会收到通知：
- en: '![](img/494b7342-9459-4985-834d-31422541588d.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](img/494b7342-9459-4985-834d-31422541588d.png)'
- en: 'The last step is to make sure that our custom events are fired when users trigger
    the action:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一步是确保当用户触发操作时，我们的自定义事件被触发：
- en: Navigate to Administration > Issues > Workflows.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 管理 > 问题 > 工作流。
- en: 'Click on the **Edit **link for the workflow, which contains the transitions
    that will fire the custom event. In this case, we will be using a simple approval
    workflow that contains a transition called **Approve**:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击工作流的**编辑**链接，工作流中包含触发自定义事件的过渡。在这个例子中，我们将使用一个简单的审批工作流，其中包含一个名为**Approve**的过渡：
- en: '![](img/89991ec3-f024-464e-84bd-74159af35b11.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/89991ec3-f024-464e-84bd-74159af35b11.png)'
- en: Click on the workflow transition, and select the **Post Functions **tab. Normally,
    you will see the last post function in the list firing **Generic Event**.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击工作流过渡，选择**后置功能**标签。通常，你会看到列表中最后一个后置功能触发**通用事件**。
- en: Hover your mouse over the post function and click on the edit icon (it looks
    like a pencil).
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将鼠标悬停在后置功能上，点击编辑图标（看起来像铅笔）。
- en: 'Select the new `Issue Approved` event and click on **Update**, as shown in
    the following screenshot. This will make the transition fire our event instead
    of the default Generic Event:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择新的`Issue Approved`事件并点击**更新**，如以下截图所示。这样会使过渡触发我们的自定义事件，而不是默认的通用事件：
- en: '![](img/0953245b-c72b-4e16-994b-77e35d8f28f2.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0953245b-c72b-4e16-994b-77e35d8f28f2.png)'
- en: Let's see how the steps work.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这些步骤是如何工作的。
- en: How it works...
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Jira's email templates use the Apache Velocity ([http://velocity.apache.org](http://velocity.apache.org/))
    template language to display dynamic data. Each template is a mix of static text
    (with or without HTML markups) and some Velocity code. If you do not need to have
    dynamic contents, then you can only have static text in your templates.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: Jira的电子邮件模板使用Apache Velocity（[http://velocity.apache.org](http://velocity.apache.org/)）模板语言来展示动态数据。每个模板都是静态文本（有或没有HTML标记）和一些Velocity代码的混合。如果你不需要动态内容，那么你的模板中就可以只有静态文本。
- en: In our previous examples, every time you see the dollar sign (`$`), such as
    in the phrase `$issue.key`, it is a piece of Velocity code. The `$` sign is an
    instruction to get a variable from the Velocity context, and the variable name
    is the word that comes directly after the `$` sign so, in this case, it is `issue`. The
    period character (`.`) is an instruction to get the specified value from the variable.
    So, `$issue.key` can be read as *get the value of key from the variable issue*,
    or in other words, *get me the issue's key*.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们之前的示例中，每次看到美元符号（`$`）时，比如在短语`$issue.key`中，它表示一段Velocity代码。`$`符号是从Velocity上下文中获取变量的指令，而变量名是紧跟在`$`符号后面的单词，因此在这种情况下，变量名是`issue`。句点字符（`.`）是获取指定值的指令。所以，`$issue.key`可以理解为*从变量issue中获取key的值*，或者换句话说，*给我issue的key*。
- en: Jira exposes a number of variables in its Velocity context for email templates;
    you can find the full list at [https://confluence.atlassian.com/display/JIRA041/Velocity+Context+for+Email+Templates](https://confluence.atlassian.com/display/JIRA041/Velocity+Context+for+Email+Templates).
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Jira在其Velocity上下文中暴露了多个变量供电子邮件模板使用；你可以在[https://confluence.atlassian.com/display/JIRA041/Velocity+Context+for+Email+Templates](https://confluence.atlassian.com/display/JIRA041/Velocity+Context+for+Email+Templates)找到完整的列表。
- en: So, if we take a look at our templates, for the subject template, the `($issue.key)
    $issue.summary` Velocity code will be turned into something like `IT-10 Request
    for Jira administrator access`, where `IT-10` replaces `$issue.key` and `Request
    for Jira administrator access` replaces `$issue.summary`.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，如果我们看看我们的模板，对于主题模板，`($issue.key) $issue.summary`的Velocity代码将被转换为类似`IT-10
    Request for Jira administrator access`的内容，其中`IT-10`替换了`$issue.key`，`Request for
    Jira administrator access`替换了`$issue.summary`。
- en: You can also have conditional logic in your Velocity templates. In our example,
    we have an `if/else` condition. We check to see if there is a comment accompanying
    the approve transition, and if there is, we will display the comment. If there
    is no comment, then we simply display No Comment in italic font.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以在Velocity模板中使用条件逻辑。在我们的示例中，我们有一个`if/else`条件。我们检查是否有评论伴随批准的过渡，如果有，我们将显示该评论。如果没有评论，我们将简单地以斜体字体显示“无评论”。
- en: 'The following screenshot shows a sample email generated from the custom template
    that we have created, displayed in Gmail:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了我们创建的自定义模板生成的示例电子邮件，显示在Gmail中：
- en: '![](img/1bfe5151-cb11-429b-9d49-3caff5b455db.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1bfe5151-cb11-429b-9d49-3caff5b455db.png)'
- en: Now, onto the custom Issue Approved event. Unlike system events, custom events
    can only be fired from workflow transitions (or custom script code), so we have
    to update our workflows. Every workflow transition fires an event, and by default,
    the Generic Event is fired. This means that most workflow transitions will have
    the same notification recipient using the email template.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，进入自定义问题批准事件。与系统事件不同，自定义事件只能通过工作流过渡（或自定义脚本代码）触发，因此我们必须更新工作流。每个工作流过渡都会触发一个事件，默认情况下，触发的是通用事件。这意味着大多数工作流过渡将使用相同的通知接收者和*电子邮件*模板。
- en: By configuring the workflow to fire our own custom event, we have finer control
    over who receives notifications and which templates to use.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 通过配置工作流来触发我们自己的自定义事件，我们可以更精细地控制谁接收通知以及使用哪些模板。
- en: Disabling outgoing notifications
  id: totrans-136
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 禁用外发通知
- en: This recipe shows you how to completely prevent Jira from sending out emails.
    You may need to do this if you are performing testing, performing data migration,
    or cloning a new development instance, and do not want to flood users with hundreds
    of test notifications.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程展示了如何完全阻止Jira发送电子邮件。如果你正在进行测试、数据迁移或克隆一个新的开发实例，并且不想让用户收到数百条测试通知，你可能需要这样做。
- en: How to do it...
  id: totrans-138
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作步骤...
- en: 'Go through the following steps to disable outgoing notifications in Jira:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤禁用Jira中的外发通知：
- en: Navigate to **Administration **> **System** > **Outgoing Mail**.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**管理** > **系统** > **外发邮件**。
- en: Click on the **Disable Outgoing Mail **button.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**禁用外发邮件**按钮。
- en: Once you have disabled outgoing mail, Jira will no longer send out notifications.
    If you want to re-enable outgoing mail, simply click on the Enable Outgoing Mail
    button, and Jira will start sending out emails again.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦禁用外发邮件，Jira将不再发送通知。如果你想重新启用外发邮件，只需点击“启用外发邮件”按钮，Jira将重新开始发送邮件。
- en: Creating mail handlers to process incoming emails
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建邮件处理器以处理传入的电子邮件
- en: Jira is not only able to send emails to users, but also to poll and process
    emails. It can also create issues or add comments to existing issues. When set
    up correctly, this can be a powerful way to let your users interact with Jira.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: Jira不仅能够向用户发送*电子邮件*，还能够轮询和处理电子邮件。它还可以*创建*问题或向现有问题添加评论。当配置正确时，这可以是一个强大的方式，让用户与Jira进行交互。
- en: In this recipe, we will set up Jira to poll incoming emails so that it can create
    new issues and add comments to the existing issues. This is useful in a help-desk
    scenario where customers can write an email to the support email address of the
    company and let Jira automatically create issues from them.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将设置Jira轮询传入的电子邮件，以便它可以创建新问题并向现有问题添加评论。这在帮助台场景中非常有用，客户可以向公司支持电子邮件地址发送电子邮件，Jira会自动从中创建问题。
- en: Getting ready
  id: totrans-146
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'Since Jira will be polling email from an inbox, you need to have its connection
    details, including the following:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 由于Jira将从邮箱中轮询电子邮件，你需要获取其连接详情，包括以下内容：
- en: The protocol it supports (for example, **POP **or **IMAP**)
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它支持的协议（例如，**POP**或**IMAP**）
- en: Authentication details
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 身份验证详情
- en: How to do it...
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 操作步骤...
- en: 'The first step to configure Jira for processing incoming email is to set up
    the inboxes that Jira will use to poll the email from:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 配置Jira处理来邮件的第一步是设置Jira用来轮询电子邮件的邮箱：
- en: Navigate to Administration > System > Incoming Mail.
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**管理** > **系统** > **传入邮件**。
- en: Click on the Add POP / IMAP mail server button.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“添加POP/IMAP邮件服务器”按钮。
- en: Enter a name for the new mail server. We will be using this when adding the
    mail handler later.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入新邮件服务器的名称。稍后我们在添加邮件处理器时将使用这个名称。
- en: Provide the credentials and click on the Test Connectionbutton to make sure
    that Jira is able to connect to the mail server. If the test is successful, click
    on the Add button. After we have set up the mail inbox, we can set up what are
    known as mail handlers in Jira to poll and process email. In this recipe, we will
    use the most common handler to create and/or comment on issues from email contents.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供凭证并点击“测试连接”按钮，确保Jira能够连接到邮件服务器。如果测试成功，点击“添加”按钮。设置好邮箱后，我们可以在Jira中设置所谓的邮件处理器来轮询和处理电子邮件。在本教程中，我们将使用最常见的处理器根据电子邮件内容创建和/或评论问题。
- en: Click on the Add incoming mail handlerbutton.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“添加传入邮件处理器”按钮。
- en: Enter a name for the mail handler.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入邮件处理器的名称。
- en: Select the mail server you just added from the Server drop-down list.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从“服务器”下拉列表中选择刚刚添加的邮件服务器。
- en: You can use the Local Files option to test your configuration. This allows you
    to place a test email on the filesystem so that you do not have to send test emails
    all the time.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用本地文件选项来测试你的配置。这允许你将测试邮件放在文件系统中，这样你就不必每次都发送测试邮件。
- en: Set the Delaytimer in minutes for how often the handler should poll for new
    emails. Generally, you should not set the time too short: `5` minutes is usually
    a good delay.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置延迟计时器，以确定处理器多久轮询一次新邮件。通常，你不应将时间设置得太短：`5`分钟通常是一个合适的延迟时间。
- en: Select the `Create a new issue or add a comment to an existing issue` handler.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 `创建一个新问题或向现有问题添加评论` 处理器。
- en: 'Click on the Next button to configure the mail handler, as shown in the following
    screenshot:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 Next 按钮以配置邮件处理器，如下图所示：
- en: '![](img/93e8b645-4d2e-4d35-8af5-aa2272442363.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](img/93e8b645-4d2e-4d35-8af5-aa2272442363.png)'
- en: 'Enter the mail handler configuration details. The most important configurations
    are as follows:'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入邮件处理器的配置细节。最重要的配置如下：
- en: '**Project**: You can only select one project. All emails from the inbox will
    go into the selected project.'
  id: totrans-165
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**项目**：你只能选择一个项目。所有来自收件箱的邮件将进入所选项目。'
- en: '**Issue Type**: This is the issue type from which new issues will be created.'
  id: totrans-166
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**问题类型**：这是将用来创建新问题的类型。'
- en: '**Create Users**: Check this if you want to automatically create a new account
    based on the email addresses. Note that this will count toward your license seat.'
  id: totrans-167
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建用户**：如果你希望根据电子邮件地址自动创建新账户，请勾选此项。请注意，这将计入你的许可证席位。'
- en: '**Default Reporter**: If you do not want to create new accounts, you can select
    an existing user who will be the reporter for all new issues created from emails.'
  id: totrans-168
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**默认报告人**：如果你不想创建新账户，可以选择一个现有的 用户 作为所有通过邮件创建的新问题的报告人。'
- en: Click on the Add button to create the mail handler.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击添加按钮以创建邮件处理器。
- en: 'The following table explains the various parameters that you need to set:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 下表解释了你需要设置的各种参数：
- en: '| **Parameter** | **Description** |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| **参数** | **描述** |'
- en: '| Project | This is where the project''s new issues will be created. Note that
    this is only used for creating new issues. While adding comments, this is ignored,
    as comments will be added to the issue key specified in the subject. |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| 项目 | 这是新问题将被创建的项目。请注意，这仅用于创建新问题。当添加评论时，忽略此项，因为评论将添加到主题中指定的问题键。 |'
- en: '| Issue Type | This is the issue type for all newly created issues. |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| 问题类型 | 这是所有新创建问题的默认问题类型。 |'
- en: '| Strip Quotes | If this option is checked, the text wrapped in quotes will
    not be used as an issue description or comment. |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| 去除引号 | 如果选中此选项，括在引号中的文本将不会作为问题描述或评论使用。 |'
- en: '| Catch Email Address | An email with the specified address will be processed
    if this option is selected. |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| 捕获邮件地址 | 如果选择此选项，带有指定地址的邮件将会被处理。 |'
- en: '| Bulk | This option dictates how to process autogenerated emails, such as
    an email from Jira. This is to prevent the creation of a loop where Jira sends
    email to the same inbox that it is polling the email from. |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| 批量处理 | 该选项决定如何处理自动生成的邮件，如来自 Jira 的邮件。此选项旨在防止创建循环，其中 Jira 向其正在轮询的相同收件箱发送邮件。
    |'
- en: '| Forward Email | This option sets an address to which Jira can forward all
    the emails that it cannot process. |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| 转发邮件 | 该选项设置一个地址，Jira 会将其无法处理的所有邮件转发到该地址。 |'
- en: '| Create Users | This option creates a new user if the sender''s email address
    cannot be found. |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 创建用户 | 如果无法找到发件人的邮件地址，选中此选项将创建一个新用户。 |'
- en: '| Default Reporter | This option sets the user who will be used as the reporter
    if the sender''s email address cannot be found. |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| 默认报告人 | 该选项设置在无法找到发件人邮件地址时使用的报告人。 |'
- en: '| Notify Users | Uncheck this option if you do not want Jira to send an account-related
    email. |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| 通知用户 | 如果你不希望 Jira 发送与账户相关的邮件，请取消选中此选项。 |'
- en: '| CC Assignee | Check this option if you want the first user in the CC list
    to be the issue''s assignee if a matching account can be found. |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| 抄送负责人 | 如果希望抄送列表中的第一个用户成为问题的负责人，且能找到匹配的账户，请勾选此选项。 |'
- en: '| CC Watchers | Check this option if you want to add the CC list as watchers
    to the issue if matching accounts can be found. |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| 抄送观察者 | 如果你希望将抄送列表中的用户作为观察者添加到问题中，且可以找到匹配的账户，请勾选此选项。 |'
- en: 'The following screenshot shows these parameters:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了这些参数：
- en: '![](img/eb768386-bb51-4dca-b4a3-065654a6dc37.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eb768386-bb51-4dca-b4a3-065654a6dc37.png)'
- en: It's time to see the working information.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 是时候查看工作信息了。
- en: How it works...
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Mail handlers periodically poll for new emails from the selected incoming mail
    server and process them based on the handler used. The Create a new issue or add
    a comment to an existing issue handlers will create a new issue in Jira, where
    the email subject becomes the issue summary and the email body becomes the issue
    description. If the email subject contains an issue key to an existing issue,
    the email body will be added as a comment to the issue.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 邮件处理器会定期从所选的传入邮件服务器轮询新邮件，并根据所使用的处理器进行处理。创建新问题或向现有问题添加评论的处理器会在 Jira 中创建一个新问题，其中电子邮件的主题将成为问题摘要，电子邮件的正文将成为问题描述。如果电子邮件主题包含现有问题的关键字，则电子邮件正文将作为评论添加到该问题中。
- en: '**Add a comment from the non-quoted email body**: This adds the email body
    that is not quoted with the `>` or `|` symbols as a comment to an existing issue.'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从未引用的电子邮件正文中添加评论**：这会将没有用 `>` 或 `|` 符号引用的电子邮件正文作为评论添加到现有问题中。'
- en: '**Add a comment with the entire email body**: This adds the entire email body
    as a comment to an existing issue.'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**将整个电子邮件正文添加为评论**：这会将整个电子邮件正文作为评论添加到现有问题中。'
- en: '**Create a new issue from each email message**: This always creates a new issue
    from an email.'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从每封电子邮件创建一个新问题**：这会始终从电子邮件创建一个新问题。'
- en: '**Add a comment before a specified marker or a separator in the email body**:
    This adds the email body *before *a marker line is specified as a regular expression.
    Contents *after *the marker will be ignored. This is useful when you do not want
    to include old contents from a forwarded email. Depending on the email client
    being used, you will need to use regular expressions (regex) to work out the text
    to be excluded. For most cases, the following regex will work:'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在电子邮件正文中的指定标记或分隔符前添加注释**：这将在指定为正则表达式的标记行之前添加电子邮件正文内容。标记之后的内容将被忽略。当你不想包含转发邮件中的旧内容时，这个功能非常有用。根据所使用的电子邮件客户端，你需要使用正则表达式（regex）来处理需要排除的文本。对于大多数情况，以下正则表达式会有效：'
- en: '[PRE3]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Using email to update Jira issues
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用电子邮件更新 Jira 问题
- en: Jira's out-of-the-box mail handlers mostly focus on creating new issues from emails
    or adding comments to existing issues, based on certain matching criteria. In
    this recipe, we will look at how to update an existing issue via email.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: Jira 开箱即用的邮件处理器主要侧重于根据特定的匹配标准从电子邮件创建新问题或向现有问题添加评论。在本教程中，我们将看看如何通过电子邮件更新现有问题。
- en: Getting ready
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: For this recipe, we need to have the **Enterprise Mail Handler for Jira** (**JEMH**)
    app installed. You can download the app from [https://marketplace.atlassian.com/plugins/com.javahollic.jira.jemh-ui](https://marketplace.atlassian.com/plugins/com.javahollic.jira.jemh-ui).
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个教程，我们需要安装 **Jira 的企业邮件处理器（JEMH）** 应用。你可以从 [https://marketplace.atlassian.com/plugins/com.javahollic.jira.jemh-ui](https://marketplace.atlassian.com/plugins/com.javahollic.jira.jemh-ui)
    下载该应用。
- en: How to do it...
  id: totrans-197
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Once you have the app installed, the first step is to create a profile. You
    can think of a profile as a configuration scheme in Jira, such as a workflow scheme.
    The profile contains all aspects of the configuration settings that are needed
    for processing incoming emails. To create a new profile, go through the following
    steps:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦安装了应用程序，第一步是创建一个配置文件。你可以将配置文件看作是 Jira 中的配置方案，例如工作流方案。该配置文件包含了处理传入电子邮件所需的所有配置设置。要创建一个新的配置文件，请按照以下步骤操作：
- en: Navigate to Administration > Manage apps > Configure JEMH.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 管理 > 管理应用 > 配置 JEMH。
- en: Select the Profiles option from the left-hand navigation panel.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧导航面板中选择 配置文件 选项。
- en: Click the Create Profile button.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击创建配置文件按钮。
- en: 'Enter a name for the profile, select `DEVELOPMENT` in the Readiness field,
    and click Create Profile:'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入配置文件的名称，在 **准备状态** 字段中选择 `DEVELOPMENT`，然后点击 创建配置文件：
- en: '![](img/bfc95b45-cdf9-45cc-bd4a-53aa7d7737a6.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bfc95b45-cdf9-45cc-bd4a-53aa7d7737a6.png)'
- en: 'With the profile created, we now need to configure it so that the JEMH app
    will know how to process incoming emails. The first step is to create an incoming
    mail handler by going through the following steps:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 创建好配置文件后，我们需要对其进行配置，使得 JEMH 应用能够知道如何处理传入的电子邮件。第一步是通过以下步骤创建一个传入邮件处理器：
- en: Navigate to Administration > System > Incoming Mail.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 管理 > 系统 > 传入邮件。
- en: Click on the Add incoming mail handler button.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击添加传入邮件处理器按钮。
- en: Enter a name for the new mail handler.
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入新邮件处理器的名称。
- en: Select the Enterprise Mail Handler (JEMH) for Jira as the **Handler** option
    and click **Next**.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 **Jira 的企业邮件处理器（JEMH）** 作为 **处理器** 选项，然后点击 **下一步**。
- en: 'Select the JEMH profile we have just created and click Submit:'
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择我们刚刚创建的 JEMH 配置文件并点击提交：
- en: '![](img/6cbadd48-2115-49cd-8df3-018bc270f115.png)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6cbadd48-2115-49cd-8df3-018bc270f115.png)'
- en: 'So now that we have an incoming mail handler that is associated with our JEMH
    profile, the next step is to configure it to process our email content:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经有了一个与 JEMH 配置文件关联的接收邮件处理程序，下一步是配置它来处理我们的电子邮件内容：
- en: Click on the **Configure** link for our JEMH profile.
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**配置**链接，进入我们的 JEMH 配置文件。
- en: Select the **Field Processors** option.
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**字段处理器**选项。
- en: Enable the **Colon Suffix (Mailform)** option.
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用**冒号后缀（Mailform）**选项。
- en: Click the **Save** button.
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: You may choose any format or combination of formats for field processors, and
    it is usually a good idea to enable multiple processors so that Jira can understand
    and process more than one. The important point here is that, whichever option
    you choose, you need to communicate this with your end users so they will understand
    how to craft their emails so that they can be successfully processed by Jira.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以选择任何格式或格式组合作为字段处理器，通常建议启用多个处理器，这样 Jira 可以理解并处理多种格式。这里的重要一点是，无论你选择哪个选项，都需要与最终用户进行沟通，以便他们理解如何编写电子邮件，使其能够被
    Jira 成功处理。
- en: 'Look at the following screenshot:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下截图：
- en: '![](img/7930addf-9fa7-47cf-bd2c-67ed67d0c4e1.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7930addf-9fa7-47cf-bd2c-67ed67d0c4e1.png)'
- en: 'This is the minimum required configuration to set up an incoming mail handler
    so that you can update your issues with emails. With all the configurations in
    place, the easiest way to test things out is to use the test case feature provided
    by the app, which avoids the need to send a real email around to all interested
    users. We can set this up by going through the following steps:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 这是设置接收邮件处理程序所需的最小配置，这样你就可以通过电子邮件更新问题了。所有配置完成后，测试的最简单方法是使用应用提供的测试用例功能，这样就不需要将真实的邮件发送给所有相关用户。我们可以通过以下步骤来设置：
- en: Select the Test Cases option from the left-hand navigation panel.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从左侧导航面板中选择测试用例选项。
- en: Click on the Create button.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击创建按钮。
- en: Replace the Subject with the key of an existing issue in the Content textbox.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在内容文本框中将主题替换为现有问题的关键字。
- en: 'Add the following content under the **Content** textbox:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**内容**文本框下添加以下内容：
- en: '[PRE4]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Click the Update and run button.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击更新并运行按钮。
- en: 'You should now see the result of running the test case:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你应该能够看到运行测试用例的结果：
- en: '![](img/0f4a19bf-d44c-4b71-b04e-b40921a49d6c.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0f4a19bf-d44c-4b71-b04e-b40921a49d6c.png)'
- en: As shown in the previous screenshot, and the issue you have referenced in the
    test case would have its summary and description values changed to the preceding
    content.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 如前一张截图所示，测试用例中引用的问题将会其摘要和描述值更改为之前的内容。
- en: How it works...
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The JEMH profile contains all the configurations needed for the app to process
    emails. By creating an incoming mail handler and selecting Enterprise Mail Handler for
    Jira (JEMH) as the handler, Jira will be able to pass on the processing to the
    JEMH app.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: JEMH 配置文件包含了应用处理电子邮件所需的所有配置。通过创建一个接收邮件处理程序并选择 Jira 的企业邮件处理程序（JEMH）作为处理程序，Jira
    就可以将处理任务交给 JEMH 应用。
- en: 'The one key configuration in our recipe is the field processors. The field
    processor determines how email content should be processed, which directly determines
    the format for our emails if we want them to be processed correctly. JEMH comes
    with several processors, and we have chosen to use the Colon Suffix processor,
    which has the format of `key:value`. So in our test-case email, we have the name
    of the field we want to update as the key and the new value we want to assign
    to the field as the value—for example, `summary: this is a new summary`.'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '我们方案中的一个关键配置是字段处理器。字段处理器决定了电子邮件内容应该如何处理，这直接决定了我们希望电子邮件正确处理时的格式。JEMH 提供了多个处理器，我们选择使用带有
    `key:value` 格式的冒号后缀处理器。因此，在我们的测试用例电子邮件中，我们将要更新的字段名称作为关键字，将要分配给该字段的新值作为值——例如，`summary:
    这是一个新的总结`。'
- en: Setting up a project-specific From email address
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置项目特定的发件人电子邮件地址
- en: By default, all notifications sent from Jira will have the same From address,
    configured as a part of the outgoing mail server; however, it is possible to override
    this at the project level so that each project can have its own From address.
    This can be very useful if you want to let users reply directly to notifications
    and have the reply added as a comment.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，从 Jira 发送的所有通知将使用相同的发件人地址，该地址作为外发邮件服务器的一部分进行配置；然而，你也可以在项目级别覆盖此设置，从而使每个项目拥有自己的发件人地址。如果你希望用户能够直接回复通知并将回复作为评论添加，这将非常有用。
- en: How to do it...
  id: totrans-234
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Go through the following steps to set up a project-specific From address:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤设置项目专用的发件人地址：
- en: Browse to the project from which you want to set up a specific From address.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 浏览到你希望设置特定发件人地址的项目。
- en: Click on the Project settingsoption.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 项目设置 选项。
- en: 'Click on the pencil (edit) icon for the Email in Notificationssection, as shown
    in the following screenshot:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击电子邮件通知部分中的铅笔（编辑）图标，如下图所示：
- en: '![](img/152dcb16-21c8-4803-a7ae-3bd100b141d3.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![](img/152dcb16-21c8-4803-a7ae-3bd100b141d3.png)'
- en: Enter the email address dedicated to the project.
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入专门用于该项目的电子邮件地址。
- en: Click on Update to apply the changes.
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 更新 以应用更改。
- en: You can revert to the default values by leaving the field blank.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过留空该字段来恢复默认值。
