["```\n$ git clone git@github.com:PacktPublishing/Learn-Ansible-Second-Edition.git\n```", "```\n$ docker image pull bridgecrew/checkov:latest\n```", "```\n$ cd Learn-Ansible-Second-Edition/Chapter13\n$ docker container run --rm --tty --volume ./:/ansible --workdir /ansible bridgecrew/checkov --directory /ansible\n```", "```\nansible scan results:\nPassed checks: 5, Failed checks: 3, Skipped checks: 0\n```", "```\nCheck: CKV_ANSIBLE_2: \"Ensure that certificate validation isn't disabled with get_url\"\n     PASSED for resource: tasks.ansible.builtin.get_url.download wp-cli\n     File: /roles/wordpress/tasks/main.yml:11-17\n```", "```\nCheck: CKV_ANSIBLE_5: \"Ensure that packages with untrusted or missing signatures are not used\"\n     PASSED for resource: tasks.ansible.builtin.apt.update apt-cache and upgrade packages\n     File: /roles/stack-install/tasks/main.yml:5-13\nCheck: CKV_ANSIBLE_5: \"Ensure that packages with untrusted or missing signatures are not used\"\n     PASSED for resource: tasks.ansible.builtin.apt.update cache and install the stack packages\n     File: /roles/stack-install/tasks/main.yml:27-33\n```", "```\nCheck: CKV_ANSIBLE_6: \"Ensure that the force parameter is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state\"\n     PASSED for resource: tasks.ansible.builtin.apt.update apt-cache and upgrade packages\n     File: /roles/stack-install/tasks/main.yml:5-13\nCheck: CKV_ANSIBLE_6: \"Ensure that the force parameter is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state\"\n     PASSED for resource: tasks.ansible.builtin.apt.update cache and install the stack packages\n     File: /roles/stack-install/tasks/main.yml:27-33\n```", "```\nCheck: CKV_AWS_88: \"EC2 instance should not have public IP.\"\n     FAILED for resource: tasks.amazon.aws.ec2_instance.Create the temporary ec2 instance\n     File: /roles/ec2tmp/tasks/main.yml:53-75\n      Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12\n           62 |     network:\n           63 |       assign_public_ip: \"{{ ec2.public_ip }}\"\n```", "```\nCheck: CKV_AWS_135: \"Ensure that EC2 is EBS optimized\"\n     FAILED for resource: tasks.amazon.aws.ec2_instance.Create the temporary ec2 instance\n     File: /roles/ec2tmp/tasks/main.yml:53-75\n     Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized\n```", "```\nCheck: CKV2_ANSIBLE_2: \"Ensure that HTTPS url is used with get_url\"\n     FAILED for resource: tasks.ansible.builtin.get_url.download wp-cli\n    File: /roles/wordpress/tasks/main.yml:11-17\n           11 | - name: \"download wp-cli\"\n           12 |   ansible.builtin.get_url:\n           13 |     url: \"{{ wp_cli.download }}\"\n           14 |     dest: \"{{ wp_cli.path }}\"\n```", "```\n- name: \"Create the temporary ec2 instance\"\n  amazon.aws.ec2_instance:\n    # checkov:skip=CKV_AWS_88:\"While a public IP address is assigned to the instance, it is locked down by the security group and the instance is temporary.\"\n    ebs_optimized: true\n    name: \"{{ ec2_tmp_name }}\"\n```", "```\n- name: \"download wp-cli\"\n  ansible.builtin.get_url:\n    # checkov:skip=CKV2_ANSIBLE_2:\"The URL passed in the variable is secured with SSL/TLS protocol.\"\n    url: \"{{ wp_cli.download }}\"\n    dest: \"{{ wp_cli.path }}\"\n```", "```\n$ git switch chapter13-checkov\n```", "```\n$ docker container run --rm --tty --volume ./:/ansible --workdir /ansible bridgecrew/checkov --directory /ansible\n```", "```\nansible scan results:\nPassed checks: 6, Failed checks: 0, Skipped checks: 2\n```", "```\nCheck: CKV_AWS_135: \"Ensure that EC2 is EBS optimized\"\n     PASSED for resource: tasks.amazon.aws.ec2_instance.Create the temporary ec2 instance\n      File: /roles/ec2tmp/tasks/main.yml:53-77\n      Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized\n```", "```\nCheck: CKV_AWS_88: \"EC2 instance should not have public IP.\"\n     SKIPPED for resource: tasks.amazon.aws.ec2_instance.Create the temporary ec2 instance\n     Suppress comment: \"While a public IP address is assigned to the instance, it is locked down by the security group and the instance is temporary.\"\n     File: /roles/ec2tmp/tasks/main.yml:53-77\n     Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12\n```", "```\nCheck: CKV2_ANSIBLE_2: \"Ensure that HTTPS url is used with get_url\"\n     SKIPPED for resource: tasks.ansible.builtin.get_url.download wp-cli\n     Suppress comment: \"The URL passed in the variable is secured with SSL/TLS protocol.\"\n     File: /roles/wordpress/tasks/main.yml:11-18\n```", "```\n$ git clone https://github.com/russmckendrick/Learn-Ansible-Second-Edition-Scan.git\n```", "```\n$ docker image pull checkmarx/kics:latest\n```", "```\n$ cd Learn-Ansible-Second-Edition-Scan\n```", "```\n$ docker container run --rm --tty --volume ./:/ansible checkmarx/kics scan --path /ansible/\n```", "```\nScanning with Keeping Infrastructure as Code Secure v1.7.12\nPreparing Scan Assets: Done\nExecuting queries: [------------------------------] 100.00%\nFiles scanned: 33\nParsed files: 32\nQueries loaded: 292\nQueries failed to execute: 0\n```", "```\nRisky File Permissions, Severity: INFO, Results: 5\nDescription: Some modules could end up creating new files on disk with permissions that might be too open or unpredictable\nPlatform: Ansible\nLearn more about this vulnerability: https://docs.kics.io/latest/queries/ansible-queries/common/88841d5c-d22d-4b7e-a6a0-89ca50e44b9f\n```", "```\n[1]: ../../ansible/destroy.yml:52\n     051:     - name: \"Delete the group_vars/generated_aws_endpoints.yml file\"\n     052:       ansible.builtin.file:\n     053:         path: \"group_vars/generated_aws_endpoints.yml\"\n```", "```\n[2]: ../../ansible/destroy.yml:81\n     080:     - name: \"Delete the group_vars/generated_efs_targets.yml file\"\n     081:       ansible.builtin.file:\n     082:         path: \"group_vars/generated_efs_targets.yml\"\n```", "```\nUnpinned Package Version, Severity: LOW, Results: 1\nDescription: Setting state to latest performs an update and installs additional packages possibly resulting in performance degradation or loss of service\nPlatform: Ansible\nLearn more about this vulnerability: https://docs.kics.io/latest/queries/ansible-queries/common/c05e2c20-0a2c-4686-b1f8-5f0a5612d4e8\n```", "```\n[1]: ../../ansible/roles/stack_install/tasks/main.yml:8\n      007:     name: \"*\"\n      008:     state: \"latest\"\n      009:     update_cache: true\n```", "```\nEFS Without Tags, Severity: LOW, Results: 1\nDescription: Amazon Elastic Filesystem should have filesystem tags associated\nPlatform: Ansible\nLearn more about this vulnerability: https://docs.kics.io/latest/queries/ansible-queries/aws/b8a9852c-9943-4973-b8d5-77dae9352851\n```", "```\n[1]: ../../ansible/destroy.yml:75\n      074:     - name: \"Delete the EFS File System\"\n      075:       community.aws.efs:\n      076:         name: \"{{ efs_name }}\"\n```", "```\n# kics-scan disable=88841d5c-d22d-4b7e-a6a0-89ca50e44b9f\n```", "```\n- name: \"Generate the efs targets vars file\"\n  ansible.builtin.template:\n    src: \"targets.j2\"\n    dest: \"group_vars/generated_efs_targets.yml\"\n    mode: \"0644\"\n```", "```\n- name: \"Download wp-cli\"\n  ansible.builtin.get_url:\n    url: \"{{ wp_cli.download }}\"\n    dest: \"{{ wp_cli.path }}\"\n```", "```\n- name: \"Update permissions of wp-cli to allow anyone to execute it\"\n  ansible.builtin.file:\n    path: \"{{ wp_cli.path }}\"\n    mode: \"0755\"\n```", "```\n    mode: \"0755\"\n```", "```\n# kics-scan disable=c05e2c20-0a2c-4686-b1f8-5f0a5612d4e8\n```", "```\n# kics-scan disable=88841d5c-d22d-4b7e-a6a0-89ca50e44b9f,b8a9852c-9943-4973-b8d5-77dae9352851\n```", "```\nEFS Not Encrypted, Severity: HIGH, Results: 2\nDescription: Elastic File System (EFS) must be encrypted\nPlatform: Ansible\nLearn more about this vulnerability: https://docs.kics.io/latest/queries/ansible-queries/aws/727c4fd4-d604-4df6-a179-7713d3c85e20\n```", "```\n[1]: ../../ansible/roles/efs/tasks/main.yml:25\n     024: - name: \"Create the EFS File System\"\n     025:   community.aws.efs:\n```", "```\n[2]: ../../ansible/destroy.yml:77\n     076:     - name: \"Delete the EFS File System\"\n     077:       community.aws.efs:\n```", "```\n# kics-scan disable=88841d5c-d22d-4b7e-a6a0-89ca50e44b9f,b8a9852c-9943-4973-b8d5-77dae9352851,050f085f-a8db-4072-9010-2cca235cc02f,727c4fd4-d604-4df6-a179-7713d3c85e20\n```", "```\n- name: \"Create the EFS File System\"\n  community.aws.efs:\n    encrypt: true\n    name: \"{{ efs_name }}\"\n```", "```\nEFS Without KMS, Severity: HIGH, Results: 2\nDescription: Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys\nPlatform: Ansible\nLearn more about this vulnerability: https://docs.kics.io/latest/queries/ansible-queries/aws/bd77554e-f138-40c5-91b2-2a09f878608e\n```", "```\n# kics-scan disable=bd77554e-f138-40c5-91b2-2a09f878608e\n```", "```\nResults Summary:\nHIGH: 4\nMEDIUM: 0\nLOW: 2\nINFO: 5\nTOTAL: 11\n```", "```\n$ git switch chapter13-kics\n```", "```\n$ docker container run --rm --tty --volume ./:/ansible checkmarx/kics scan --path /ansible/\n```", "```\nScanning with Keeping Infrastructure as Code Secure v1.7.13\nPreparing Scan Assets: Done\nExecuting queries: [------------------------------] 100.00%\nResults Summary:\nHIGH: 0\nMEDIUM: 0\nLOW: 0\nINFO: 0\nTOTAL: 0\n```", "```\n$ docker container run --rm --tty --volume ./:/ansible checkmarx/kics scan --path /ansible/ --report-formats \"html\" --output-path /ansible/\n```"]